<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html b:version='2' expr:dir='data:blog.languageDirection' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
    <meta charset='utf-8'/>
    <title><data:blog.pageTitle/></title>
    <meta content='width=device-width, initial-scale=1' name='viewport'/>
    
    
    <b:skin><![CDATA[
      /* 
       * FUSION THEME SKIN 
       */
      :root {
          --bs-primary: #000000 !important; 
          --bs-primary-rgb: 0,0,0 !important;
      }
      body { background-color: #ffffff; color: #212529; font-family: 'Inter', sans-serif; overflow-x: hidden; scroll-behavior: smooth; }
      .reveal { opacity: 0; transform: translateY(30px); transition: 0.6s ease-out; }
      .reveal.active { opacity: 1; transform: translateY(0); }
      .header { display: none !important; }
      .main-content img { max-width: 100%; height: auto; }
      .blog-feeds { display: none !important; }
      
      /* --- COUNTER & BADGE CONFIGURATION AREA --- */
      .nav-icon {
          margin-left: 15px; 
          margin-right: 15px;
          position: relative;
          cursor: pointer;
      }

      .icon-count {
          position: absolute !important;
          top: 2px !important;       
          right: -12px !important;   
          z-index: 999 !important;
          font-size: 11px !important;
          height: 18px !important;
          min-width: 18px !important;
          padding: 0 4px !important; 
          background-color: #dc3545 !important;
          color: white !important;
          border-radius: 9px !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          box-shadow: 0 0 2px rgba(0,0,0,0.5) !important;
      }
      
      .floating-btn .icon-count {
          top: -5px !important;
          right: -5px !important;
      }

      /* --- NEW: TESTIMONIALS STYLE --- */
      .testimonial-card {
          background: #fff;
          padding: 2rem;
          border-radius: 15px;
          box-shadow: 0 5px 20px rgba(0,0,0,0.05);
          height: 100%;
          text-align: center;
      }
      .stars { color: #ffc107; margin-bottom: 1rem; }

      /* OLD SYSTEM STYLES */
      #navbar-iframe-container { display: none !important; }
      .toast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 9999; width: 90%; max-width: 350px; display: none; }
      .toast-body { font-weight: 500; font-size: 1rem; color: white; padding: 10px; }
      .btn-close-white { filter: brightness(0) invert(1); }
      
      .sidebar { position: fixed; top: 0; right: -100%; width: 100%; max-width: 400px; height: 100vh; background-color: white; box-shadow: -5px 0 15px rgba(0,0,0,0.1); z-index: 1050; transition: right 0.3s ease; display: flex; flex-direction: column; }
      .sidebar.open { right: 0; }
      .sidebar-header { padding: 1rem; background-color: var(--bs-primary); color: white; display: flex; justify-content: space-between; align-items: center; }
      #wishlistSidebar .sidebar-header { background-color: #dc3545; }
      .sidebar-body { flex-grow: 1; overflow-y: auto; padding: 1rem; }
      .sidebar-footer { padding: 1rem; border-top: 1px solid #eee; display: none; }
      
      .sidebar-item { display: flex; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid #eee; }
      .sidebar-item img { width: 60px; height: 60px; object-fit: cover; border-radius: 8px; margin-right: 1rem; }
      .sidebar-item-title { font-weight: 600; margin-bottom: 0.25rem; }
      .sidebar-item-price { color: var(--bs-primary); font-weight: 500; }
      
      .phone-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1060; display: none; align-items: center; justify-content: center; padding: 1rem; }
      .phone-modal-content { background-color: white; border-radius: 12px; width: 100%; max-width: 450px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); max-height: 90vh; overflow-y: auto; }
      
      /* Quick View Modal Styles */
      .quick-view-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1060; display: none; align-items: center; justify-content: center; padding: 1rem; }
      .quick-view-modal-content { background-color: white; border-radius: 12px; width: 100%; max-width: 800px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: flex; flex-direction: column; }
      .quick-view-details { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
      .quick-view-image img { width: 100%; height: auto; object-fit: cover; border-radius: 8px; }
      
      /* Floating Buttons */
      .floating-btn { position: fixed; width: 56px; height: 56px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1000; cursor: pointer; transition: all 0.3s ease; text-decoration: none; color: white; }
      .floating-btn i { font-size: 1.5rem; }
      .floating-cart { bottom: 145px; right: 15px; background-color: var(--bs-primary); }
      .floating-wishlist { bottom: 80px; right: 15px; background-color: #dc3545; }
      .floating-whatsapp { bottom: 15px; right: 15px; background-color: #25D366; }
      
      /* Loading Indicator */
      .loading-spinner { width: 50px; height: 50px; border: 5px solid rgba(254, 115, 1, 0.2); border-radius: 50%; border-top-color: var(--bs-primary); animation: spin 1s ease-in-out infinite; }
      .loading-text { font-size: 1.2rem; color: var(--bs-primary); font-weight: 500; }
      @keyframes spin { to { transform: rotate(360deg); } }
      
      /* Notification Toast */
      #notificationToast { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1070; width: 90%; max-width: 350px; display: none; }
      #notificationToast .toast-body { font-weight: 500; font-size: 1rem; color: white; padding: 10px; }
      
      /* Sidebar Footer Styles */
      .sidebar-total { display: flex; justify-content: space-between; margin-bottom: 1rem; font-weight: 600; font-size: 1.1rem; }
      
      /* Responsive */
      @media (max-width: 768px) {
        .menu-grid { grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem; }
        .phone-modal-content { max-height: 90vh; padding: 1rem; }
      }

      /* ========================================== */
      /* MODULE 1 & 3: ADVANCED SEARCH & AUTH STYLES */
      /* ========================================== */
      
      /* --- ADVANCED SEARCH STYLES --- */
      #advancedFilters {
          background: #fff;
          border: 1px solid #eee;
          border-radius: 8px;
          padding: 1rem;
          margin-top: 1rem;
          display: none; /* Hidden by default */
      }
      .filter-group {
          margin-bottom: 0.5rem;
      }
      .filter-group label {
          font-weight: 600;
          font-size: 0.9rem;
          margin-bottom: 0.25rem;
          display: block;
      }
      .range-slider {
          width: 100%;
      }

      /* --- USER AUTH STYLES --- */
      .auth-nav-item {
          cursor: pointer;
          transition: color 0.2s;
      }
      .auth-nav-item:hover {
          color: var(--bs-primary) !important;
      }
      .auth-form-container .form-group {
          margin-bottom: 1rem;
      }
      .auth-form-container .form-control {
          border-radius: 8px;
          padding: 0.75rem;
      }
      .auth-switch {
          text-align: center;
          margin-top: 1rem;
          font-size: 0.9rem;
      }
      .auth-switch a {
          color: var(--bs-primary);
          text-decoration: none;
          font-weight: 600;
          cursor: pointer;
      }
      .user-avatar-display {
          display: none;
          align-items: center;
          gap: 8px;
          font-weight: 600;
          font-size: 0.9rem;
      }
      .user-avatar-img {
          width: 32px;
          height: 32px;
          background: #eee;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          color: #666;
      }

    
]]></b:skin>

    
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css' rel='stylesheet'/>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css' rel='stylesheet'/>
    <link href='https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&amp;display=swap' rel='stylesheet'/>
    
    <link href='https://cdn.jsdelivr.net/gh/gorarypro/store/style.css' rel='stylesheet' type='text/css'/>
</head>
<body id='top'>

  
  <nav class='navbar navbar-expand-lg navbar-light bg-white sticky-top shadow-sm'>
    <div class='container-fluid'>
      <a class='navbar-brand' href='#'>
        <i class='bi bi-lightning-charge-fill me-2 text-warning'/>
        <span>Event Sushi</span>
      </a>
      <button aria-controls='navbarNav' aria-expanded='false' aria-label='Toggle navigation' class='navbar-toggler' data-bs-target='#navbarNav' data-bs-toggle='collapse' type='button'>
        <span class='navbar-toggler-icon'/>
      </button>
      <div class='collapse navbar-collapse' id='navbarNav'>
        <ul class='navbar-nav ms-auto align-items-center'>
          <li class='nav-item'><a class='nav-link' href='#hero' style='color: #212529 !important;'>Home</a></li>
          <li class='nav-item'><a class='nav-link' href='#menu' style='color: #212529 !important;'>Menu</a></li>
          <li class='nav-item'><a class='nav-link' href='#about' style='color: #212529 !important;'>About</a></li>
          <li class='nav-item'><a class='nav-link' href='#contact' style='color: #212529 !important;'>Contact</a></li>
          
          <!-- BOOK TABLE BUTTON -->
          <li class='nav-item ms-lg-2 mt-2 mt-lg-0'>
            <a class='nav-link btn btn-outline-warning px-3 text-dark fw-bold' id='reservationIcon' style='color: #212529 !important; border-color: #212529 !important;'>
              Book a Table
            </a>
          </li>

          <!-- USER AUTH MODULE START -->
          <li class='nav-item' id='authSection'>
              <!-- State 1: Logged Out (Show Login) -->
              <a class='nav-link nav-icon auth-nav-item' id='loginTrigger' style='color: #212529 !important;'>
                  <i class='bi bi-person-circle'/>
                  <span style='font-size: 0.9rem; margin-left: 5px;'>Login</span>
              </a>
              
              <!-- State 2: Logged In (Show Avatar) -->
              <div class='nav-item user-avatar-display' id='userProfile'>
                  <div class='user-avatar-img'>
                      <i class='bi bi-person-fill'/>
                  </div>
                  <span id='userNameDisplay'>User</span>
                  <i class='bi bi-box-arrow-right' id='logoutTrigger' style='cursor:pointer; margin-left:5px; color:#dc3545;' title='Logout'/>
              </div>
          </li>
          <!-- USER AUTH MODULE END -->

          <!-- ICONS -->
          <li class='nav-item'>
            <a class='nav-link nav-icon' id='wishlistIcon' style='color: #212529 !important;'>
              <i class='bi bi-heart'/>
              <span class='icon-count wishlist-count' id='wishlistCount'>0</span>
            </a>
          </li>
          <li class='nav-item'>
            <a class='nav-link nav-icon' id='cartIcon' style='color: #212529 !important;'>
              <i class='bi bi-cart3'/>
              <span class='icon-count' id='cartCount'>0</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- SEARCH BAR SECTION -->
  <section class='py-3 bg-light border-bottom' id='searchSection'>
    <div class='container'>
        <div class='row justify-content-center'>
            <div class='col-md-8'> <!-- Increased width slightly for filters -->
                <div class='input-group mb-2'>
                    <span class='input-group-text bg-white'><i class='bi bi-search'/></span>
                    <input class='form-control' id='searchInput' placeholder='Search menu (e.g. Salmon, Box)...' type='text'/>
                    <button class='btn btn-outline-secondary' id='toggleFiltersBtn' type='button'>
                        <i class='bi bi-funnel'/>
                    </button>
                    <button class='btn btn-outline-secondary' id='clearSearch' type='button'>Clear</button>
                </div>
                
                <!-- ADVANCED FILTERS PANEL -->
                <div id='advancedFilters'>
                    <div class='row'>
                        <div class='col-md-6'>
                            <div class='filter-group'>
                                <label>Max Price (DH)</label>
                                <input class='form-control' id='maxPriceInput' placeholder='e.g. 100' type='number'/>
                            </div>
                        </div>
                        <div class='col-md-6'>
                            <div class='filter-group'>
                                <label>Sort By</label>
                                <select class='form-select' id='sortSelect'>
                                    <option value='default'>Default</option>
                                    <option value='price_asc'>Price: Low to High</option>
                                    <option value='price_desc'>Price: High to Low</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
  </section>
  
  <div class='toast align-items-center text-white bg-success border-0' id='notificationToast' role='alert'>
      <div class='d-flex'>
        <div class='toast-body' id='toastBody'>
          
        </div>
        <button aria-label='Close' class='btn-close btn-close-white me-2 m-auto' data-bs-dismiss='toast' type='button'/>
      </div>
    </div>

    <div class='sidebar-overlay' id='sidebarOverlay'/>

    <div class='sidebar' id='cartSidebar'>
      <div class='sidebar-header'>
        <h4 class='m-0'>Your Cart</h4>
        <i class='bi bi-x-lg' id='closeCart' style='cursor:pointer'/>
      </div>
      <div class='sidebar-body' id='cartBody'>
        <div class='empty-sidebar' id='emptyCartMessage'>
          <i class='bi bi-cart-x'/>
          <p>Your cart is empty</p>
        </div>
      </div>
      <div class='sidebar-footer' id='cartFooter' style='display: none;'>
        <div class='sidebar-total'>
          <span>Total:</span>
          <span id='cartTotal'>0 DH</span>
        </div>
        <button class='checkout-btn' id='checkoutBtn'>Proceed to Checkout</button>
      </div>
    </div>

    <div class='sidebar' id='wishlistSidebar'>
      <div class='sidebar-header'>
        <h4 class='m-0'>Your Wishlist</h4>
        <i class='bi bi-x-lg' id='closeWishlist' style='cursor:pointer'/>
      </div>
      <div class='sidebar-body' id='wishlistBody'>
        <div class='empty-sidebar' id='emptyWishlistMessage'>
          <i class='bi bi-heartbreak'/>
          <p>Your wishlist is empty</p>
        </div>
        </div>
    </div>

    <div class='phone-modal' id='phoneModal'>
      <div class='phone-modal-content'>
        <div class='phone-modal-header'>
          <h4 class='m-0'>Complete Your Order</h4>
        </div>
        <div class='phone-modal-body'>
          <div class='form-group'>
            <label for='customerPhone'>Phone Number *</label>
            <input class='form-control' id='customerPhone' placeholder='+212 6 00 00 00' required='required' type='tel'/>
          </div>
          
          <div class='info-option'>
            <p>Would you like to provide additional information?</p>
            <div class='info-options'>
              <button class='btn-secondary' id='noThanksBtn'>No, thanks</button>
              <button class='btn-primary' id='addInfoBtn'>Yes, add more info</button>
            </div>
          </div>
          
          <div id='additionalInfo' style='display:none'>
            <div class='form-group'>
              <label for='customerName'>Full Name <span class='optional-label'>(Optional)</span></label>
              <input class='form-control' id='customerName' placeholder='John Doe' type='text'/>
            </div>
            <div class='form-group'>
              <label for='customerEmail'>Email Address <span class='optional-label'>(Optional)</span></label>
              <input class='form-control' id='customerEmail' placeholder='john@example.com' type='email'/>
            </div>
            <div class='form-group'>
              <label for='customerAddress'>Delivery Address <span class='optional-label'>(Optional)</span></label>
              <textarea class='form-control' id='customerAddress' placeholder='123 Street, City' rows='3'/>
            </div>
          </div>

          <!-- COUPON SECTION -->
          <div class='alert alert-info' style='font-size: 0.9rem; padding: 10px;'>
            <strong>Try codes: SAVE10 (10% off), FREE (Delivery)</strong>
          </div>
          <div class='input-group mb-3'>
              <input class='form-control' id='couponInput' placeholder='Coupon Code' type='text'/>
              <button class='btn btn-outline-dark' id='applyCouponBtn' type='button'>Apply</button>
          </div>
          <div id='couponMessage' style='font-size: 0.85rem; margin-bottom: 10px; height: 1.2em;'/>

        </div>
        <div class='phone-modal-footer'>
          <button class='btn-cancel' id='cancelCheckout'>Cancel</button>
          <button class='btn-success' id='confirmCheckout'>
            <span id='checkoutButtonText'>Place Order</span>
            <div class='loading' id='checkoutLoading' style='display:none'/>
          </button>
        </div>
      </div>
    </div>

    <!-- RESERVATION MODAL START -->
    <div class='phone-modal' id='reservationModal'>
      <div class='phone-modal-content'>
        <div class='phone-modal-header'>
          <h4 class='m-0'>Reserve a Table</h4>
          <i class='bi bi-x-lg' id='closeReservation' style='cursor:pointer'/>
        </div>
        <div class='phone-modal-body'>
          <div class='form-group mb-3'>
            <label for='resName'>Full Name *</label>
            <input class='form-control' id='resName' placeholder='John Doe' required='required' type='text'/>
          </div>
          
          <div class='form-group mb-3'>
            <label for='resPhone'>Phone Number *</label>
            <input class='form-control' id='resPhone' placeholder='+212 6 00 00 00' required='required' type='tel'/>
          </div>

          <div class='row'>
            <div class='col-6 mb-3'>
              <label for='resDate'>Date *</label>
              <input class='form-control' id='resDate' type='date'/>
            </div>
            <div class='col-6 mb-3'>
              <label for='resTime'>Time *</label>
              <input class='form-control' id='resTime' type='time'/>
            </div>
          </div>

          <div class='form-group mb-3'>
            <label for='resGuests'>Number of Guests *</label>
            <select class='form-control' id='resGuests'>
              <option value='2'>2 People</option>
              <option value='4'>4 People</option>
              <option value='6'>6 People</option>
              <option value='8+'>8+ People</option>
            </select>
          </div>
          
          <div class='form-group'>
            <label for='resNotes'>Special Requests</label>
            <textarea class='form-control' id='resNotes' placeholder='e.g. Birthday, High chair needed...' rows='2'/>
          </div>
        </div>
        <div class='phone-modal-footer'>
          <button class='btn-cancel' id='cancelReservation'>Cancel</button>
          <button class='btn-success' id='confirmReservation'>
            <span id='resButtonText'>Confirm Booking</span>
            <div class='loading' id='resLoading' style='display:none'/>
          </button>
        </div>
      </div>
    </div>
    <!-- RESERVATION MODAL END -->

    <!-- LOGIN MODAL START -->
    <div class='phone-modal' id='loginModal'>
        <div class='phone-modal-content' style='max-width: 400px;'>
            <div class='phone-modal-header'>
                <h4 class='m-0'>Welcome Back</h4>
                <i class='bi bi-x-lg' id='closeLogin' style='cursor:pointer'/>
            </div>
            <div class='phone-modal-body auth-form-container'>
                <form id='loginForm'>
                    <div class='form-group'>
                        <label>Email Address</label>
                        <input class='form-control' id='loginEmail' placeholder='name@example.com' required='required' type='email'/>
                    </div>
                    <div class='form-group'>
                        <label>Password</label>
                        <input class='form-control' id='loginPassword' placeholder='********' required='required' type='password'/>
                    </div>
                    <button class='btn btn-dark w-100' style='width:100%; border-radius:8px;' type='submit'>Login</button>
                </form>
                <div class='auth-switch'>
                    Don&#39;t have an account? <a id='goToRegister'>Register here</a>
                </div>
            </div>
        </div>
    </div>
    <!-- LOGIN MODAL END -->

    <!-- REGISTER MODAL START -->
    <div class='phone-modal' id='registerModal'>
        <div class='phone-modal-content' style='max-width: 400px;'>
            <div class='phone-modal-header'>
                <h4 class='m-0'>Create Account</h4>
                <i class='bi bi-x-lg' id='closeRegister' style='cursor:pointer'/>
            </div>
            <div class='phone-modal-body auth-form-container'>
                <form id='registerForm'>
                    <div class='form-group'>
                        <label>Full Name</label>
                        <input class='form-control' id='regName' placeholder='John Doe' required='required' type='text'/>
                    </div>
                    <div class='form-group'>
                        <label>Email Address</label>
                        <input class='form-control' id='regEmail' placeholder='name@example.com' required='required' type='email'/>
                    </div>
                    <div class='form-group'>
                        <label>Password</label>
                        <input class='form-control' id='regPassword' placeholder='Create a password' required='required' type='password'/>
                    </div>
                    <button class='btn btn-dark w-100' style='width:100%; border-radius:8px;' type='submit'>Sign Up</button>
                </form>
                <div class='auth-switch'>
                    Already have an account? <a id='goToLogin'>Login here</a>
                </div>
            </div>
        </div>
    </div>
    <!-- REGISTER MODAL END -->

    <div class='quick-view-modal' id='quickViewModal'>
      <div class='quick-view-modal-content'>
        <div class='quick-view-modal-header'>
          <h4 id='quickViewTitle'>Product Title</h4>
          <button class='btn-close' id='closeQuickView' type='button'><i class='bi bi-x'/></button>
        </div>
        <div class='quick-view-modal-body'>
          <div class='quick-view-details'>
            <div class='quick-view-image'>
              <img alt='Product Image' id='quickViewImage' src='https://placehold.co/600x400'/>
            </div>
            <div class='quick-view-info'>
              <div class='price' id='quickViewPrice'>0 DH</div>
              <p class='description' id='quickViewDescription'>Loading product details...</p>
              <button class='order-btn' id='quickViewAddToCartBtn'>
                <i class='bi bi-cart-plus'/>
                Add to Cart
              </button>
            </div>
          </div>
          <div class='related-products'>
            <h5>Related Products</h5>
            <div class='related-products-grid' id='relatedProductsGrid'>
              
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class='floating-btn floating-cart' id='floatingCart'>
      <i class='bi bi-cart3'/>
      <span class='icon-count' id='floatingCartCount'>0</span>
    </div>
  
  <div class='floating-btn floating-wishlist' id='floatingWishlist'>
      <i class='bi bi-heart-fill'/>
      <span class='icon-count' id='floatingWishlistCount'>0</span>
    </div>
  
  <a class='floating-btn floating-whatsapp' href='https://wa.me/212600000000' id='floatingWhatsapp' target='_blank'>
    <i class='bi bi-whatsapp'/>
  </a>

  <header id='hero'>
    <div class='container'>
      <h1>Event Sushi</h1>
      <p>Fresh. Authentic. Made with Love üç£</p>
      <a class='btn' href='#menu'>Explore Menu</a>
    </div>
  </header>

  <section id='menu'>
    <div class='container'>
      <h2>üç£ Our Menu</h2>
      <p>Choose from our selection of Minibox, Box, Appetizers, and Taco options</p>
      
      <div class='loading-container' id='loadingContainer' style='display: none;'>
        <div class='loading-spinner'/>
        <div class='loading-text'>Loading menu...</div>
      </div>
      
      <div class='error-container' id='errorContainer' style='display: none;'>
        <div class='error-icon'>
          <i class='bi bi-exclamation-triangle-fill'/>
        </div>
        <h3 class='error-title'>Unable to Load Menu</h3>
        <p class='error-message'>A network error occurred. Please check: <br/>
            1. Your internet connection. <br/>
            2. That the Apps Script URL is correct. <br/>
            3. That the script is deployed for &quot;Anyone&quot;.
          </p>
        <button class='retry-btn' id='retryBtn'>Try Again</button>
      </div>
      
      <!-- Menu Container -->
      <div class='filter-container' id='filterContainer'>
        <button class='filter-btn active' data-filter='all'>All</button>
      </div>
      <div id='menuSections' style='display: none;'/>
    </div>
  </section>

  <!-- TESTIMONIALS SECTION (C) -->
  <section class='py-5 bg-light mt-5' id='testimonials'>
      <div class='container text-center'>
          <h2 class='mb-5 fw-bold'>What our customers say</h2>
          <div class='row g-4'>
              <!-- Review 1 -->
              <div class='col-md-4'>
                  <div class='testimonial-card'>
                      <div class='stars'><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/></div>
                      <p class='fst-italic text-muted'>&quot;Absolutely the best sushi in town! The delivery was fast and the fish was incredibly fresh.&quot;</p>
                      <h5 class='mt-3'>Sarah J.</h5>
                      <small class='text-muted'>Regular Customer</small>
                  </div>
              </div>
              <!-- Review 2 -->
              <div class='col-md-4'>
                  <div class='testimonial-card'>
                      <div class='stars'><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-half'/></div>
                      <p class='fst-italic text-muted'>&quot;Great selection of boxes. I love the spicy tuna roll. Highly recommended for quick office lunches.&quot;</p>
                      <h5 class='mt-3'>Ahmed K.</h5>
                      <small class='text-muted'>Food Blogger</small>
                  </div>
              </div>
              <!-- Review 3 -->
              <div class='col-md-4'>
                  <div class='testimonial-card'>
                      <div class='stars'><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/></div>
                      <p class='fst-italic text-muted'>&quot;The &#39;Book a Table&#39; feature is so convenient. We reserved for our anniversary and they treated us like royalty.&quot;</p>
                      <h5 class='mt-3'>Yasmine M.</h5>
                      <small class='text-muted'>Verified Diner</small>
                  </div>
              </div>
          </div>
      </div>
  </section>

  <section id='about'>
    <div class='container'>
      <h2>About Us</h2>
      <p>Welcome to <strong>Event Sushi</strong> &#8212; your home for fresh, handcrafted sushi and Japanese delicacies. Every roll is made with passion and the highest quality ingredients. Whether you&#39;re dining in or ordering for your next event, we bring Japan to your plate!</p>
    </div>
  </section>

  <section id='contact'>
    <div class='container'>
      <h2>Contact Us</h2>
      <p><i class='bi bi-geo-alt'/> 123 Sushi Street, Casablanca</p>
      <p><i class='bi bi-telephone'/> +212 6 00 00 00 00</p>
      <p><i class='bi bi-envelope'/> hello@goraryplace.com</p>
      <a class='btn btn-outline-light mt-3' href='#hero'>Back to Top</a>
    </div>
  </section>

  <b:section class='main' id='Main' showaddelement='yes'/>

  <footer>
      &amp;copy; 2025 Event Sushi. all rights reserved.
  </footer>

  <script>//<![CDATA[

    window.FUSION_CONFIG = {
      "asset_base_url":"https://cdn.jsdelivr.net/gh/gorarypro/multipurpose-website-builder@main/multipurpose-website-builder/src/assets/",
      "site_title":"",
      "primary_color":"#000000",
      "hero_title":"",
      "hero_subtitle":"Experience the finest flavors in Casablanca.",
      "hero_image_url":"",
      "meta_description":"",
      "favicon_url":"",
      "google_verify":"",
      "default_language":"en",
      "currency_symbol":"",
      "base_url":"eventsushi1.blogspot.com",
      "hero_included":true,
      "pricing_included":"no",
      "floating_buttons_included":"yes",
      "popup_included":"no", 
      "contact_whatsapp":"",
      "contact_email":"",
      "order_success_msg":"",
      "github_repo":"gorarypro/multipurpose-website-builder",
      "github_token":"ghp_ozLnsNCmES40m490xul6GoEEFTJNrT3RUUMZ",
      "search_included":"yes",         
      "wishlist_included":true,
      "quickview_included":true,
      "cart_included":true,
      "analytics_included":"no",
      "contact_form_msg":"",
      "thank_you_url":"",
      "error_url":"",
      "xml_output":"",
      "blogger_feed_url":"https://eventsushi1.blogspot.com/feeds/posts/default?alt=json&max-results=50",
      "gallery_included":false,       
      "popup_enabled":false,         
      "popup_delay":5000,
      "popup_content":"",
      "theme_name":"",
      "popup_title":"Special Weekend Offer!",
      "popup_message":"",
      "popup_cta_text":"Shop the Sale",
      "popup_cta_link":"#products",
      "popup_expiry_days":1,
      "primary_color_hex":"",
      "navbarIncluded":true,         
      "heroIncluded":true,           
      "productGridIncluded":true,    
      "cartIncluded":true,           
      "wishlistIncluded":true,       
      "popupIncluded":false,         
      "floatingButtonsIncluded":true, 
      "footerIncluded":true,         
      "themeName":"Fusion_Master_Theme"
    };
    window.FUSION_TEXTMAPPING = {"HOME":{"en":"Home","fr":"Accueil","ar":"ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©"},"PRODUCTS":{"en":"Products","fr":"Produits","ar":"ŸÖŸÜÿ™ÿ¨ÿßÿ™ŸÜÿß"},"CONTACT":{"en":"Contact","fr":"Contact","ar":"ÿßÿ™ÿµŸÑ ÿ®ŸÜÿß"},"CHECKOUT":{"en":"Checkout","fr":"Paiement","ar":"ÿßŸÑÿØŸÅÿπ"},"TEXT_TOTAL":{"en":"Total","fr":"Total","ar":"ÿßŸÑÿ•ÿ¨ŸÖÿßŸÑŸä"},"WISHLIST":{"en":"Wishlist","fr":"Favoris","ar":"ÿßŸÑŸÖŸÅÿ∂ŸÑÿ©"},"CART_EMPTY":{"en":"Your cart is empty","fr":"Panier vide","ar":"ÿßŸÑÿ≥ŸÑÿ© ŸÅÿßÿ±ÿ∫ÿ©"},"TEXT_BROWSE_PRODUCTS":{"en":"Browse products","fr":"Parcourir les produits","ar":"ÿ™ÿµŸÅÿ≠ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™"},"TEXT_CONTACT_US":{"en":"Contact us","fr":"Contactez-nous","ar":"ÿ™ŸàÿßÿµŸÑ ŸÖÿπŸÜÿß"},"TEXT_CONTACT_INTRO":{"en":"Send us a message","fr":"Envoyez-nous un message","ar":"ÿ£ÿ±ÿ≥ŸÑ ŸÑŸÜÿß ÿ±ÿ≥ÿßŸÑÿ©"},"TEXT_NAME":{"en":"Your name","fr":"Votre nom","ar":"ÿßÿ≥ŸÖŸÉ"},"TEXT_EMAIL":{"en":"Your email","fr":"Votre email","ar":"ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä"},"TEXT_MESSAGE":{"en":"Your message","fr":"Votre message","ar":"ÿ±ÿ≥ÿßŸÑÿ™ŸÉ"},"TEXT_SEND_MESSAGE":{"en":"Send message","fr":"Envoyer","ar":"ÿ£ÿ±ÿ≥ŸÑ ÿßŸÑÿ±ÿ≥ÿßŸÑÿ©"},"TEXT_CART":{"en":"Cart","fr":"Panier","ar":"ÿßŸÑÿ≥ŸÑÿ©"},"TEXT_CLOSE":{"en":"Close","fr":"Fermer","ar":"ÿ•ÿ∫ŸÑÿßŸÇ"},"TEXT_CONTINUE_SHOPPING":{"en":"Continue shopping","fr":"Continuer vos achats","ar":"ÿ™ÿßÿ®ÿπ ÿßŸÑÿ™ÿ≥ŸàŸÇ"},"TEXT_SORT_LATEST":{"en":"Latest","fr":"Plus r√©cent","ar":"ÿßŸÑÿ£ÿ≠ÿØÿ´"},"TEXT_SORT_PRICE_ASC":{"en":"Price (low to high)","fr":"Prix croissant","ar":"ÿßŸÑÿ≥ÿπÿ± ÿ™ÿµÿßÿπÿØŸä"},"TEXT_SORT_PRICE_DESC":{"en":"Price (high to low)","fr":"Prix d√©croissant","ar":"ÿßŸÑÿ≥ÿπÿ± ÿ™ŸÜÿßÿ≤ŸÑŸä"},"TEXT_NO_PRODUCTS":{"en":"No products found","fr":"Aucun produit","ar":"ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿ™ÿ¨ÿßÿ™"},"TEXT_WISHLIST":{"en":"Wishlist","fr":"Favoris","ar":"ÿßŸÑŸÖŸÅÿ∂ŸÑÿ©"},"TEXT_WISHLIST_EMPTY":{"en":"Your wishlist is empty","fr":"Pas de favoris","ar":"ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© ŸÅÿßÿ±ÿ∫ÿ©"},"TEXT_TESTIMONIALS":{"en":"Testimonials","fr":"T√©moignages","ar":"ÿ¢ÿ±ÿßÿ° ÿßŸÑÿπŸÖŸÑÿßÿ°"},"TEXT_TESTIMONIALS_SUBTITLE":{"en":"What our customers say","fr":"Ce que disent nos clients","ar":"ŸÖÿßÿ∞ÿß ŸäŸÇŸàŸÑ ÿπŸÖŸÑÿßÿ§ŸÜÿß"},"TEXT_TESTIMONIAL_SAMPLE":{"en":"Great service and quality!","fr":"Service et qualit√© au top!","ar":"ÿÆÿØŸÖÿ© ÿ±ÿßÿ¶ÿπÿ© Ÿàÿ¨ŸàÿØÿ© ÿπÿßŸÑŸäÿ©!"},"TEXT_TESTIMONIAL_ROLE":{"en":"Customer","fr":"Client","ar":"ÿπŸÖŸäŸÑ"},"TEXT_PRICING":{"en":"Pricing","fr":"Tarifs","ar":"ÿßŸÑÿ£ÿ≥ÿπÿßÿ±"},"TEXT_PRICING_SUBTITLE":{"en":"Choose the plan that fits you","fr":"Choisissez votre formule","ar":"ÿßÿÆÿ™ÿ± ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑŸÖŸÜÿßÿ≥ÿ®ÿ©"},"TEXT_PLAN_BASIC":{"en":"Basic","fr":"Essentiel","ar":"ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©"},"TEXT_PLAN_BASIC_SUBTITLE":{"en":"Good for starters","fr":"Pour bien commencer","ar":"ÿ¨ŸäÿØÿ© ŸÑŸÑŸÖÿ®ÿ™ÿØÿ¶ŸäŸÜ"},"TEXT_MONTH":{"en":"month","fr":"mois","ar":"ÿ¥Ÿáÿ±"},"TEXT_FEATURE_1":{"en":"Feature 1","fr":"Caract√©ristique 1","ar":"ÿßŸÑŸÖŸäÿ≤ÿ© 1"},"TEXT_FEATURE_2":{"en":"Feature 2","fr":"Caract√©ristique 2","ar":"ÿßŸÑŸÖŸäÿ≤ÿ© 2"},"TEXT_CHOOSE_PLAN":{"en":"Choose plan","fr":"Choisir cette offre","ar":"ÿßÿÆÿ™ÿ± ÿßŸÑÿÆÿ∑ÿ©"},"TEXT_ALL_RIGHTS_RESERVED":{"en":"All rights reserved","fr":"Tous droits r√©serv√©s","ar":"ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ©"},"TEXT_BACK_TO_TOP":{"en":"Back to top","fr":"Haut de page","ar":"ÿ•ŸÑŸâ ÿßŸÑÿ£ÿπŸÑŸâ"},"TEXT_PRIVACY":{"en":"Privacy policy","fr":"Politique de confidentialit√©","ar":"ÿ≥Ÿäÿßÿ≥ÿ© ÿßŸÑÿÆÿµŸàÿµŸäÿ©"},"TEXT_TERMS":{"en":"Terms","fr":"Conditions g√©n√©rales","ar":"ÿßŸÑÿ¥ÿ±Ÿàÿ∑ ŸàÿßŸÑÿ£ÿ≠ŸÉÿßŸÖ"},"TEXT_ALL":{"en":"All","fr":"Tous","ar":"ÿßŸÑŸÉŸÑ"},"TEXT_PHONE":{"en":"Phone","fr":"T√©l√©phone","ar":"Ÿáÿßÿ™ŸÅ"},"TEXT_WHATSAPP":{"en":"WhatsApp","fr":"WhatsApp","ar":"Ÿàÿßÿ™ÿ≥ÿßÿ®"},"TEXT_PRODUCTS":{"en":"Products","fr":"Produits","ar":"ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™"}};
  
]]></script>
  
  
  <script>//<![CDATA[

    window.FUSION_CATALOG = [{"title":"Box","posts":[{"id":"tag:blogger.com,1999:blog-2235355400309817414.post-8819692674067994875","title":"Meal Box 1","price":"0.00 DH","image":"https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhIEp-qZS2ymtmrPXri7_Iso6Ea7_8XUELUNd8kih4kjEbboOW5BVNhRzvPCPpr8blGRTRHpxPxQztEY9X6sPP2oJzL8jupOj2Waq_EGijP8y-PVeuQ2BbvTY-yv_pg2EQtodySoBNS4bHoHQIEn9oXWmj0him8BYWyHsnArRXRhhTbWbnXx6BwHN2p3HY/s320/nigiri-12%20%281%29.jpg","link":"https://eventsushi1.blogspot.com/2025/11/test.html","description":"DESCRIPTION..."}]}];
  
]]></script>
  
  
  <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js'/>
  
  
  <script src='https://cdn.jsdelivr.net/gh/gorarypro/store/app.js?v=2.0' type='text/javascript'/>
  
  
  <script>//<![CDATA[

    (function() {
      'use strict';
      
      // Minimal Fusion Config to keep existing features happy
      // NOTE: We do not define window.FUSION = {} here to avoid conflicts.
      if (typeof window.FUSION === 'undefined') {
        window.FUSION = {};
      }

      window.FUSION.Menu = {
        data: [],
        init: function() {
          if (typeof window.FUSION_CATALOG !== 'undefined' && window.FUSION_CATALOG.length > 0) {
            this.data = window.FUSION_CATALOG;
            window.dispatchEvent(new Event('FUSION_CATALOG_LOADED'));
          }
        },
        render: function() {}
      };

      // Initialize local Fusion
      window.FUSION.Menu.init();
      
    })();
    
    /*
     * APP.JS PATCH FOR DOUBLE ADD BUG
     */
    
    window.updateWishlistUI = function() {
      var wishlistBody = document.getElementById('wishlistBody');
      var emptyWishlistMessage = document.getElementById('emptyWishlistMessage');
      var wishlistCountNav = document.getElementById('wishlistCount');
      var floatingWishlistCount = document.getElementById('floatingWishlistCount');
      
      var wishlist = (typeof window.wishlist !== 'undefined') ? window.wishlist : [];
      
      var totalItems = wishlist.length;
      if (wishlistCountNav) wishlistCountNav.textContent = totalItems;
      if (floatingWishlistCount) floatingWishlistCount.textContent = totalItems;

      if (!wishlistBody) return;

      if (wishlist.length === 0) {
        wishlistBody.innerHTML = ''; 
        if (emptyWishlistMessage) emptyWishlistMessage.style.display = 'block';
      } else {
        if (emptyWishlistMessage) emptyWishlistMessage.style.display = 'none';
        
        var wishlistHTML = '';
        wishlist.forEach(function(item) {
          wishlistHTML += `
            <div class='sidebar-item' data-id='${item.id}'>
              <img src='${item.imageUrl}' alt='${item.title}'>
              <div class='sidebar-item-info'>
                <div class='sidebar-item-title'>${item.title}</div>
                <div class='sidebar-item-price'>${item.price} ${item.currency}</div>
              </div>
              <div class='sidebar-item-actions'>
                <button class='add-to-cart-from-wishlist-btn' data-id='${item.id}' aria-label="Add to Cart">
                  <i class="bi bi-cart-plus"></i>
                </button>
                <button class='remove-from-wishlist-btn' data-id='${item.id}' aria-label="Remove from Wishlist">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </div>
          `;
        });
        wishlistBody.innerHTML = wishlistHTML;
      }
    };
    
    if (typeof window.wishlist !== 'undefined') {
        window.updateWishlistUI();
    }

  // 7. PAGE SPECIFIC (Reveal) -->
  // <
![CDATA[
      function reveal() {
          var reveals = document.querySelectorAll(".reveal");
          for (var i = 0; i < reveals.length; i++) {
            var windowHeight = window.innerHeight;
            var revealTop = reveals[i].getBoundingClientRect().top;
            if (revealTop < windowHeight - 150) {
              reveals[i].classList.add("active");
            }
          }
      }
      window.addEventListener("scroll", reveal); 
      window.addEventListener("load", reveal);
  
]]></script>

<!-- NEW: OPEN/CLOSED LOGIC -->
<script>//<![CDATA[
    (function() {
        var badge = document.getElementById('openStatusBadge');
        if(!badge) return;
        
        var openHour = 11; 
        var closeHour = 23; 
        
        var now = new Date();
        var currentHour = now.getHours();

        if (currentHour >= openHour && currentHour < closeHour) {
            badge.className = "badge rounded-pill px-3 py-2 bg-success text-white";
            badge.innerHTML = "<i class='bi bi-door-open'></i> Open Now";
        } else {
            badge.className = "badge rounded-pill px-3 py-2 bg-danger text-white";
            badge.innerHTML = "<i class='bi bi-door-closed'></i> Closed";
        }
    })();
]]></script>

<!-- NEW: RESERVATION LOGIC (FIXED) -->
<script>//<![CDATA[
    (function() {
        'use strict';

        // 1. GET ELEMENTS (Safe Check)
        var openBtn = document.getElementById('reservationIcon');
        var modal = document.getElementById('reservationModal');
        var closeBtn = document.getElementById('closeReservation');
        var cancelBtn = document.getElementById('cancelReservation');
        var confirmBtn = document.getElementById('confirmReservation');
        
        // If button is not found, wait and try again (Fixes "nothing happens" bug)
        if (!openBtn) {
            setTimeout(arguments.callee, 500); 
            return; 
        }
        if (!modal) { return; }
        if (!closeBtn) { return; }
        if (!cancelBtn) { return; }
        if (!confirmBtn) { return; }

        // 2. ATTACH LISTENERS
        if (openBtn) {
            openBtn.addEventListener('click', function() {
                if(modal) modal.style.display = 'flex';
            });
        }

        function closeModal() {
            if(modal) modal.style.display = 'none';
        }
        
        if(closeBtn) closeBtn.addEventListener('click', closeModal);
        if(cancelBtn) cancelBtn.addEventListener('click', closeModal);

        if(confirmBtn) {
            confirmBtn.addEventListener('click', function() {
                // GET FORM VALUES (Safe Check)
                var nameEl = document.getElementById('resName');
                var phoneEl = document.getElementById('resPhone');
                var dateEl = document.getElementById('resDate');
                var timeEl = document.getElementById('resTime');
                var guestsEl = document.getElementById('resGuests');
                var notesEl = document.getElementById('resNotes');
                
                if (!nameEl || !phoneEl || !dateEl || !timeEl) {
                    alert("Please fill in all required fields.");
                    return;
                }

                var name = nameEl ? nameEl.value : "";
                var phone = phoneEl ? phoneEl.value : "";
                var date = dateEl ? dateEl.value : "";
                var time = timeEl ? timeEl.value : "";
                var guests = guestsEl ? guestsEl.value : "";
                var notes = notesEl ? notesEl.value : "";

                // BUILD WHATSAPP MESSAGE
                var message = "Hello! I would like to reserve a table.%0A%0A";
                message += "üë§ *Name:* " + name + "%0A";
                message += "üìû *Phone:* " + phone + "%0A";
                message += "üìÖ *Date:* " + date + "%0A";
                message += "‚è∞ *Time:* " + time + "%0A";
                message += "üë• *Guests:* " + guests + "%0A";
                if(notes) message += "üìù *Notes:* " + notes;

                var whatsappNumber = "212600000000"; // UPDATE THIS NUMBER
                var url = "https://wa.me/" + whatsappNumber + "?text=" + message;
                
                // OPEN WHATSAPP
                window.open(url, '_blank');
                
                // CLOSE MODAL
                closeModal();
            });
        }

    })();
]]></script>

<!-- NEW: COUPON LOGIC (A) -->
<script>//<![CDATA[
    (function() {
        'use strict';

        var couponInput = document.getElementById('couponInput');
        var applyBtn = document.getElementById('applyCouponBtn');
        var messageDiv = document.getElementById('couponMessage');
        
        window.discountValue = 0; 
        window.discountType = 'none'; 
        window.appliedCode = '';

        if(applyBtn) {
            applyBtn.addEventListener('click', function() {
                var code = couponInput.value.toUpperCase().trim();
                messageDiv.style.color = 'red';
                messageDiv.textContent = '';

                if(code === 'SAVE10') {
                    window.discountValue = 0.10; 
                    window.discountType = 'percentage';
                    window.appliedCode = 'SAVE10';
                    messageDiv.style.color = 'green';
                    messageDiv.textContent = 'Coupon Applied: 10% OFF!';
                } else if (code === 'FREE') {
                    window.discountValue = 20; 
                    window.discountType = 'fixed';
                    window.appliedCode = 'FREE';
                    messageDiv.style.color = 'green';
                    messageDiv.textContent = 'Coupon Applied: Free Delivery (20 DH off)!';
                } else {
                    window.discountValue = 0;
                    window.discountType = 'none';
                    window.appliedCode = '';
                    messageDiv.textContent = 'Invalid Code';
                }
            });
        }
    })();
]]></script>

<!-- NEW: OVERRIDDEN CHECKOUT LOGIC WITH COUPON SUPPORT (A) -->
<script>//<![CDATA[
    (function() {
        'use strict';
        
        var confirmCheckoutBtn = document.getElementById('confirmCheckout');
        var cartTotalEl = document.getElementById('cartTotal');

        if(confirmCheckoutBtn && window.FUSION && window.FUSION.Cart) {
            
            var newBtn = confirmCheckoutBtn.cloneNode(true);
            confirmCheckoutBtn.parentNode.replaceChild(newBtn, confirmCheckoutBtn);

            newBtn.addEventListener('click', function(e) {
                e.preventDefault(); 
                
                var cart = window.FUSION.Cart.get();
                if(!cart || cart.length === 0) {
                    alert("Your cart is empty!");
                    return;
                }

                var subtotal = 0;
                cart.forEach(function(item) {
                    var priceVal = parseFloat(item.price.replace(/[^0-9.-]+/g,""));
                    subtotal += priceVal * item.quantity;
                });

                var finalDiscount = 0;
                if(window.discountType === 'percentage') {
                    finalDiscount = subtotal * window.discountValue;
                } else if (window.discountType === 'fixed') {
                    finalDiscount = window.discountValue;
                }

                var total = subtotal - finalDiscount;
                if(total < 0) total = 0;

                if(cartTotalEl) cartTotalEl.textContent = total.toFixed(2) + " DH";

                var phoneEl = document.getElementById('customerPhone');
                if(!phoneEl) { alert("Please enter phone number"); return; }
                var phone = phoneEl ? phoneEl.value : "";

                var message = "Hello! I would like to place an order.%0A%0A";
                
                cart.forEach(function(item) {
                    message += "- " + item.quantity + "x " + item.title + " (" + item.price + ")%0A";
                });

                message += "%0A*Subtotal:* " + subtotal.toFixed(2) + " DH%0A";
                
                if(finalDiscount > 0) {
                    message += "*Discount (" + window.appliedCode + "):* -" + finalDiscount.toFixed(2) + " DH%0A";
                }
                
                message += "*Total:* " + total.toFixed(2) + " DH%0A";
                message += "%0APhone: " + phone;

                var whatsappNumber = "212600000000"; 
                var url = "https://wa.me/" + whatsappNumber + "?text=" + message;
                window.open(url, '_blank');

                var phoneModal = document.getElementById('phoneModal');
                if(phoneModal) phoneModal.style.display = 'none';
            });
        }
    })();
]]></script>

<!-- NEW: SEARCH LOGIC (B) - DATA FILTER METHOD - WITH SAFE CHECKS -->
<!-- REPLACED WITH COMPREHENSIVE AUTH + ADVANCED SEARCH LOGIC -->
<script>//<![CDATA[
    (function() {
        'use strict';

        // ==========================================
        // MODULE 3: USER AUTHENTICATION (SIMULATION)
        // ==========================================
        const Auth = {
            init: function() {
                // Check local storage for user session
                const user = JSON.parse(localStorage.getItem('site_user'));
                if (user) {
                    this.updateUI(true, user);
                } else {
                    this.updateUI(false);
                }
                this.bindEvents();
            },

            login: function(email, name) {
                // Simulate backend auth
                const user = { email: email, name: name || 'User', token: 'dummy-token-' + Date.now() };
                localStorage.setItem('site_user', JSON.stringify(user));
                this.updateUI(true, user);
                this.closeModals();
                
                // Show success toast
                const toast = document.getElementById('notificationToast');
                const toastBody = document.getElementById('toastBody');
                if(toast && toastBody) {
                    toastBody.textContent = "Welcome back, " + user.name + "!";
                    toast.classList.remove('bg-success', 'border-0');
                    toast.classList.add('bg-success', 'border-0');
                    toast.style.display = 'flex';
                    setTimeout(() => { toast.style.display = 'none'; }, 3000);
                }
            },

            logout: function() {
                localStorage.removeItem('site_user');
                this.updateUI(false);
                location.reload(); // Refresh to clear state
            },

            updateUI: function(isLoggedIn, user) {
                const loginTrigger = document.getElementById('loginTrigger');
                const userProfile = document.getElementById('userProfile');
                const userNameDisplay = document.getElementById('userNameDisplay');

                if (isLoggedIn && user) {
                    if (loginTrigger) loginTrigger.style.display = 'none';
                    if (userProfile) userProfile.style.display = 'flex';
                    if (userNameDisplay) userNameDisplay.textContent = user.name.split(' ')[0]; // Show first name
                } else {
                    if (loginTrigger) loginTrigger.style.display = 'flex';
                    if (userProfile) userProfile.style.display = 'none';
                }
            },

            bindEvents: function() {
                // Modal Toggles
                document.getElementById('loginTrigger').addEventListener('click', () => document.getElementById('loginModal').style.display = 'flex');
                document.getElementById('closeLogin').addEventListener('click', () => document.getElementById('loginModal').style.display = 'none');
                document.getElementById('closeRegister').addEventListener('click', () => document.getElementById('registerModal').style.display = 'none');
                
                document.getElementById('goToRegister').addEventListener('click', () => {
                    document.getElementById('loginModal').style.display = 'none';
                    document.getElementById('registerModal').style.display = 'flex';
                });
                
                document.getElementById('goToLogin').addEventListener('click', () => {
                    document.getElementById('registerModal').style.display = 'none';
                    document.getElementById('loginModal').style.display = 'flex';
                });

                document.getElementById('logoutTrigger').addEventListener('click', () => this.logout());

                // Form Handling
                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const email = document.getElementById('loginEmail').value;
                    // In a real app, verify password here
                    this.login(email, email.split('@')[0]); 
                });

                document.getElementById('registerForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const name = document.getElementById('regName').value;
                    const email = document.getElementById('regEmail').value;
                    this.login(email, name);
                });
            },

            closeModals: function() {
                document.getElementById('loginModal').style.display = 'none';
                document.getElementById('registerModal').style.display = 'none';
            }
        };

        // Initialize Auth
        Auth.init();

        // ==========================================
        // MODULE 1: ADVANCED SEARCH FILTERS
        // ==========================================
        
        // 1. Toggle Filter Panel
        const toggleBtn = document.getElementById('toggleFiltersBtn');
        const filterPanel = document.getElementById('advancedFilters');
        
        if(toggleBtn && filterPanel) {
            toggleBtn.addEventListener('click', function() {
                if (filterPanel.style.display === 'none') {
                    filterPanel.style.display = 'block';
                    toggleBtn.classList.add('btn-dark');
                    toggleBtn.classList.remove('btn-outline-secondary');
                } else {
                    filterPanel.style.display = 'none';
                    toggleBtn.classList.remove('btn-dark');
                    toggleBtn.classList.add('btn-outline-secondary');
                }
            });
        }

        // 2. Enhanced Search Logic
        // We need to override the previous search logic to include Price/Sort
        const searchInput = document.getElementById('searchInput');
        const maxPriceInput = document.getElementById('maxPriceInput');
        const sortSelect = document.getElementById('sortSelect');
        const clearBtn = document.getElementById('clearSearch');

        // Store original catalog safely
        var originalCatalog = [];
        try {
            if (typeof window.FUSION_CATALOG !== 'undefined' && window.FUSION_CATALOG.length > 0) {
                originalCatalog = JSON.parse(JSON.stringify(window.FUSION_CATALOG));
            }
        } catch(e) { console.error("Catalog Error", e); }

        function applyFilters() {
            if (typeof window.FUSION_CATALOG === 'undefined') return;

            const term = searchInput ? searchInput.value.toLowerCase() : "";
            const maxPrice = maxPriceInput ? parseFloat(maxPriceInput.value) : Infinity;
            const sortType = sortSelect ? sortSelect.value : 'default';

            let filteredData = JSON.parse(JSON.stringify(originalCatalog));

            // A. Filter by Text and Price
            filteredData = filteredData.map(function(category) {
                var filteredPosts = category.posts.filter(function(post) {
                    // 1. Text Match
                    var titleMatch = post.title && post.title.toLowerCase().includes(term);
                    var descMatch = post.description && post.description.toLowerCase().includes(term);
                    
                    // 2. Price Match (Extract number from string like "50.00 DH")
                    var priceVal = 0;
                    if(post.price) {
                        priceVal = parseFloat(post.price.replace(/[^0-9.-]+/g,""));
                    }
                    var priceMatch = priceVal <= maxPrice;

                    return (titleMatch || descMatch) && priceMatch;
                });
                return { title: category.title, posts: filteredPosts };
            }).filter(function(category) {
                return category.posts.length > 0;
            });

            // B. Sort Logic
            if (sortType !== 'default') {
                filteredData.forEach(function(category) {
                    category.posts.sort(function(a, b) {
                        var priceA = parseFloat(a.price.replace(/[^0-9.-]+/g,"")) || 0;
                        var priceB = parseFloat(b.price.replace(/[^0-9.-]+/g,"")) || 0;
                        return sortType === 'price_asc' ? priceA - priceB : priceB - priceA;
                    });
                });
            }

            // Update global catalog and trigger re-render
            window.FUSION_CATALOG = filteredData;
            if (typeof window.dispatchEvent === 'function') {
                window.dispatchEvent(new Event('FUSION_CATALOG_LOADED'));
            }
        }

        // Attach Listeners
        if(searchInput) searchInput.addEventListener('input', applyFilters);
        if(maxPriceInput) maxPriceInput.addEventListener('input', applyFilters);
        if(sortSelect) sortSelect.addEventListener('change', applyFilters);
        
        if(clearBtn) {
            clearBtn.addEventListener('click', function() {
                if(searchInput) searchInput.value = '';
                if(maxPriceInput) maxPriceInput.value = '';
                if(sortSelect) sortSelect.value = 'default';
                
                // Reset Catalog
                window.FUSION_CATALOG = JSON.parse(JSON.stringify(originalCatalog));
                if (typeof window.dispatchEvent === 'function') {
                    window.dispatchEvent(new Event('FUSION_CATALOG_LOADED'));
                }
            });
        }

    })();
]]></script>

</body>
</html>
