<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html b:version='2' expr:dir='data:blog.languageDirection' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
    <meta charset='utf-8'/>
    <title><data:blog.pageTitle/></title>
    <meta content='width=device-width, initial-scale=1' name='viewport'/>
    
    <!-- FIX: Added Bootstrap CSS for layout and utilities -->
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css' rel='stylesheet'/>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css' rel='stylesheet'/>
    <link href='https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800;900&amp;display=swap' rel='stylesheet'/>

    <!-- STEP 3: GOOGLE ANALYTICS (GA4) -->
    <!-- Replace 'G-XXXXXXXXXX' with your actual Measurement ID -->
    <script async='async' src='https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX'/>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag(&#39;js&#39;, new Date());
      gtag(&#39;config&#39;, &#39;G-XXXXXXXXXX&#39;);
    </script>

    <!-- CSS VARIABLES & STYLESHEET -->
    <b:skin><![CDATA[
    /* 
     * FUSION ENGINE MASTER STYLESHEET 
     * VERSION 2026.15.2 (UPDATED: Search, Gallery, Analytics)
     */

    /* --- 1.1 ROOT THEME VARIABLES --- */
    :root {
        --fe-primary: #000000;
        --fe-accent: #ffc107;
        --fe-danger: #dc3545;
        --fe-success: #25D366;
        --fe-admin: #6f42c1;
        --fe-white: #ffffff;
        --fe-mist: #f8f9fa;
        --fe-border: #eeeeee;
        --fe-text-dark: #111111;
        --fe-text-muted: #6c757d;
        --fe-radius-xl: 40px;
        --fe-radius-lg: 25px;
        --fe-shadow: 0 20px 50px rgba(0,0,0,0.1);
        --fe-transition: 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
        --fe-bg-alt: #f8f9fa; 
    }

    /* --- 1.2 RESET & GLOBAL DEFAULTS --- */
    * { box-sizing: border-box; outline: none !important; }

    body {
        background-color: var(--fe-white);
        color: var(--fe-text-dark);
        font-family: 'Poppins', sans-serif;
        margin: 0; padding: 0;
        overflow-x: hidden;
        line-height: 1.8;
        -webkit-font-smoothing: antialiased;
    }

    /* Layout Containers */
    .container { width: 92%; max-width: 1440px; margin: 0 auto; position: relative; }
    section { padding: 100px 0; position: relative; width: 100%; clear: both; }

    /* Blogger System Overrides */
    .header, .blog-feeds, #navbar-iframe-container, .post-footer, .comments, .feed-links { display: none !important; }

    /* Animations */
    .reveal { 
        opacity: 0; 
        transform: translateY(40px); 
        transition: 0.8s cubic-bezier(0.2, 1, 0.3, 1); 
    }
    .reveal.active { opacity: 1; transform: translateY(0); }

    /* --- 1.3 NAVIGATION SYSTEM --- */
    .fe-navbar {
        position: fixed; top: 0; left: 0; width: 100%; height: 80px;
        background: rgba(255, 255, 255, 0.95); 
        backdrop-filter: blur(15px);
        border-bottom: 1px solid var(--fe-border); 
        z-index: 5000;
        display: flex; align-items: center;
    }
    .nav-inner { display: flex; justify-content: space-between; align-items: center; width: 100%; }

    .fe-logo { 
        font-weight: 900; font-size: 1.8rem; color: #000; 
        text-decoration: none; letter-spacing: -1.5px;
    }
    .fe-logo span { color: var(--fe-accent); }

    .fe-links { display: flex; align-items: center; gap: 30px; list-style: none; margin: 0; padding: 0; }
    .fe-links a { font-weight: 600; font-size: 0.9rem; color: #000; text-transform: uppercase; text-decoration: none; }
    .fe-links a:hover { color: var(--fe-accent); }

    .nav-actions { display: flex; align-items: center; gap: 20px; }
    .fe-icon { position: relative; cursor: pointer; font-size: 1.5rem; color: #000; }
    
    .fe-badge {
        position: absolute; top: -5px; right: -12px;
        background: var(--fe-danger); color: #fff;
        font-size: 10px; font-weight: 900; height: 18px; width: 18px;
        border-radius: 50%; display: flex; align-items: center; justify-content: center;
    }

    .curr-select { background: var(--fe-mist); border: 1px solid #ddd; padding: 6px 12px; border-radius: 50px; font-size: 0.8rem; font-weight: 800; cursor: pointer; }

    #adminFlag {
        display: none; background: var(--fe-admin); color: #fff;
        padding: 4px 12px; border-radius: 50px; font-size: 0.75rem;
        font-weight: 900; text-transform: uppercase; cursor: pointer;
    }

    /* --- 1.4 HERO SECTION --- */
    .fe-hero {
        height: 100vh; width: 100%;
        background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1579871494447-9811cf80d66c?q=80&amp;w=2000');
        background-size: cover; background-position: center; background-attachment: fixed;
        display: flex; align-items: center; justify-content: center; text-align: center; color: #fff;
        padding-top: 80px;
    }
    .fe-hero-inner {
        padding: 0 20px;
        backdrop-filter: brightness(1.1);
    }
    .fe-hero h1 { font-size: clamp(2.5rem, 5vw, 6rem); font-weight: 900; line-height: 1.1; margin-bottom: 20px; text-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    .fe-hero p { font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto; text-shadow: 0 2px 4px rgba(0,0,0,0.3); }

    /* --- 1.5 ABOUT & STORY --- */
    .about-wrap { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; align-items: center; }
    .about-img { position: relative; }
    .about-img img { border-radius: var(--fe-radius-xl); box-shadow: var(--fe-shadow); width: 100%; height: auto; }
    .about-badge {
        position: absolute; bottom: -20px; left: -20px;
        background: var(--fe-accent); padding: 30px; border-radius: var(--fe-radius-lg);
        box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        text-align: center;
    }

    /* --- 1.6 MENU & PRODUCT GRID --- */
    .fe-filter-bar { display: flex; justify-content: center; gap: 15px; margin-bottom: 60px; flex-wrap: wrap; }
    .btn-filter {
        padding: 12px 30px; border-radius: 50px; border: 2px solid #ddd;
        background: #fff; font-weight: 700; font-size: 0.85rem; cursor: pointer; transition: 0.3s;
    }
    .btn-filter:hover, .btn-filter.active { background: #000; color: #fff; border-color: #000; }

    .fe-product-grid { 
        display: grid; 
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
        gap: 30px; width: 100%;
    }

    .fe-card {
        background: #fff; border-radius: var(--fe-radius-lg); overflow: hidden;
        border: 1px solid var(--fe-border); transition: var(--fe-transition); position: relative;
    }
    .fe-card:hover { transform: translateY(-10px); box-shadow: var(--fe-shadow); }
    .fe-card.out-of-stock { opacity: 0.6; pointer-events: none; filter: grayscale(1); }

    .card-media-box { height: 250px; overflow: hidden; position: relative; cursor: pointer; }
    .card-media-box img { 
        width: 100%; height: 100%; object-fit: cover; 
        transition: 0.5s; 
    }
    .fe-card:hover .card-media-box img { transform: scale(1.1); }

    .wish-overlay {
        position: absolute; top: 15px; right: 15px;
        background: #fff; border: none; width: 40px; height: 40px; border-radius: 50%;
        display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
        color: #ddd; box-shadow: 0 5px 15px rgba(0,0,0,0.1); z-index: 10; transition: 0.3s; cursor: pointer;
    }
    .wish-overlay.active { color: var(--fe-danger); transform: scale(1.1); }

    .card-info-box { padding: 2rem; }
    .card-price-tag { font-weight: 800; font-size: 1.5rem; color: #000; }
    .star-display { color: var(--fe-accent); font-size: 0.9rem; margin-bottom: 10px; }

    /* --- 1.7 GALLERY SYSTEM --- */
    .fe-gallery-wrap { 
        display: grid; 
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
        gap: 20px; width: 100%;
    }
    .gallery-frame { height: 300px; border-radius: var(--fe-radius-lg); overflow: hidden; cursor: pointer; }
    .gallery-frame img { 
        width: 100%; height: 100%; object-fit: cover; 
        transition: 0.5s; 
    }
    .gallery-frame:hover img { transform: scale(1.1); filter: brightness(1.1); }

    /* --- 1.8 SIDEBAR ENGINE --- */
    .side-backdrop {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.6); backdrop-filter: blur(5px); z-index: 5999; display: none;
    }
    .fe-sidebar {
        position: fixed; top: 0; right: -100%; width: 100%; max-width: 450px;
        height: 100vh; background: #fff; z-index: 6000; transition: right 0.6s var(--fe-transition);
        display: flex; flex-direction: column;
    }
    .fe-sidebar.open { right: 0; }
    .side-head-box { padding: 20px; background: #000; color: #fff; display: flex; justify-content: space-between; align-items: center; }
    .side-body-box { flex-grow: 1; overflow-y: auto; padding: 20px; }
    .side-foot-box { padding: 20px; border-top: 1px solid var(--fe-border); background: var(--fe-bg-alt); }

    .cart-row-item { display: flex; gap: 15px; padding-bottom: 20px; margin-bottom: 20px; border-bottom: 1px solid #eee; align-items: center; }
    .cart-row-item img { width: 70px; height: 70px; border-radius: 15px; object-fit: cover; }
    
    .qty-engine { display: flex; align-items: center; gap: 10px; margin-top: 5px; }
    .qty-btn { background: #eee; width: 25px; height: 25px; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; cursor: pointer; font-size: 0.8rem; }

    /* --- 1.9 MODAL & CONTACT --- */
    .fe-modal-backdrop {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.85); z-index: 7000; display: none;
        align-items: center; justify-content: center; padding: 20px;
    }
    .fe-modal-inner { background: #fff; border-radius: 30px; width: 100%; max-width: 900px; padding: 40px; position: relative; max-height: 95vh; overflow-y: auto; }
    .fe-modal-x { position: absolute; top: 20px; right: 20px; font-size: 2rem; cursor: pointer; transition: 0.3s; color: #000; }

    .contact-form-box { background: #fff; border-radius: var(--fe-radius-lg); border: 1px solid var(--fe-border); padding: 40px; box-shadow: var(--fe-shadow); }
    .fe-control { width: 100%; background: var(--fe-bg-alt); border: 1px solid #eee; border-radius: 10px; padding: 15px 20px; margin-bottom: 20px; font-family: inherit; font-size: 1rem; transition: 0.3s; }
    .fe-control:focus { background: #fff; border-color: #000; }

    /* --- 1.10 FOOTER & FLOATING --- */
    .fe-action-floats { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; gap: 15px; z-index: 4000; }
    .btn-fe-float { width: 60px; height: 60px; border-radius: 50%; background: #000; color: #fff; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.3); cursor: pointer; transition: 0.3s; text-decoration: none; }
    .btn-fe-float:hover { transform: scale(1.1); }
    
    footer { background: #000; color: #fff; padding: 100px 0 40px; }
    .foot-grid-wrap { display: grid; grid-template-columns: 2fr 1fr 1fr 1.5fr; gap: 50px; }
    .foot-title-h { color: var(--fe-accent); font-weight: 900; font-size: 1.1rem; margin-bottom: 25px; }
    .foot-item-l { display: block; margin-bottom: 15px; opacity: 0.7; font-size: 0.95rem; text-decoration: none; color: #fff; transition: 0.3s; }
    .foot-item-l:hover { opacity: 1; padding-left: 10px; color: var(--fe-accent); }

    /* --- 1.11 RESPONSIVE MEDIA QUERIES --- */
    @media (max-width: 1200px) { .foot-grid-wrap { grid-template-columns: 1fr 1fr; } }
    @media (max-width: 991px) { 
        .fe-links { display: none !important; } 
        .about-wrap { grid-template-columns: 1fr; }
        .fe-hero h1 { font-size: 3.5rem; }
    }
    @media (max-width: 768px) {
        .fe-modal-inner { padding: 25px 20px; }
        .fe-product-grid, .fe-gallery-wrap { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; } 
        .fe-hero { padding-top: 60px; }
        .fe-hero h1 { font-size: 2.8rem; }
        section { padding: 60px 0; }
    }
]]></b:skin>
</head>
<body id='top'>

    <!-- Backdrops -->
    <div class='side-backdrop' id='sideBackdrop'/>

    <!-- Navigation -->
    <nav class='fe-navbar'>
        <div class='container nav-inner'>
            <div class='d-flex align-items-center gap-3'>
                <a class='fe-logo' href='#top'>EVENT<span>SUSHI</span></a>
                
                <select class='curr-select d-none d-lg-block' id='feGlobalCurrency'>
                    <option value='MAD'>MAD (DH)</option>
                    <option value='USD'>USD ($)</option>
                    <option value='EUR'>EUR (&#8364;)</option>
                </select>

                <div id='adminFlag'>Admin Manager</div>
            </div>

            <ul class='fe-links'>
                <li><a href='#hero'>Home</a></li>
                <li><a href='#about'>Our Story</a></li>
                <li><a href='#menu'>Menu</a></li>
                <li><a href='#gallery'>Gallery</a></li>
                <li><a href='#contact'>Contact</a></li>
            </ul>

            <div class='nav-actions'>
                <!-- STEP 2: ADD SEARCH TRIGGER ICON -->
                <div class='fe-icon' id='trigSearch'><i class='bi bi-search'/></div>
                <div class='fe-icon' id='trigUserAuth'><i class='bi bi-person-circle'/></div>
                <div class='fe-icon' id='trigWishSidebar'><i class='bi bi-heart'/><span class='fe-badge' id='badgeWishCount'>0</span></div>
                <div class='fe-icon' id='trigCartSidebar'><i class='bi bi-cart3'/><span class='fe-badge' id='badgeCartCount'>0</span></div>
            </div>
        </div>
    </nav>

    <!-- Header / Hero -->
    <header class='fe-hero' id='hero'>
        <div class='container'>
            <div class='fe-hero-inner'>
                <h1 class='reveal'>Art of <br/> Perfect Roll.</h1>
                <p class='reveal'>Casablanca&#39;s premium sushi experience. Hand-crafted with Atlantic freshness and Japanese soul.</p>
                <div class='reveal d-flex justify-content-center gap-3 flex-wrap'>
                    <a class='btn btn-warning btn-lg rounded-pill px-5 fw-bold py-3' href='#menu' style='background: var(--fe-accent); color: white; border:none;'>Order Now</a>
                    <button class='btn btn-outline-light btn-lg rounded-pill px-5 fw-bold py-3' id='btnOpenBooking' style='border-color: white;'>Book a Table</button>
                </div>
            </div>
        </div>
    </header>

    <!-- About Section -->
    <section id='about'>
        <div class='container'>
            <div class='about-wrap'>
                <div class='about-img reveal'>
                    <img class='img-fluid' src='https://images.unsplash.com/photo-1583623025817-d180a2221d0a?q=80&amp;w=1000'/>
                    <div class='about-badge'>
                        <h2 class='fw-bold text-white mb-0'>12+</h2>
                        <small class='text-white fw-bold'>Years of Artistry</small>
                    </div>
                </div>
                <div class='reveal'>
                    <h6 class='text-warning fw-bold mb-3'>OUR LEGACY</h6>
                    <h2 class='display-5 fw-bold mb-4'>Freshness Without <br/> Compromise.</h2>
                    <p class='text-muted mb-5'>Established in heart of Maarif in 2014, Event Sushi has become a beacon for those who seek highest quality seafood. We source daily to bring you 2026 excellence in every single bite.</p>
                    <div class='row g-4'>
                        <div class='col-md-6'><div class='d-flex align-items-center gap-3'><i class='bi bi-patch-check-fill text-success h2'/><span class='fw-bold'>Premium Sourcing</span></div></div>
                        <div class='col-md-6'><div class='d-flex align-items-center gap-3'><i class='bi bi-truck text-primary h2'/><span class='fw-bold'>60min Delivery</span></div></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Menu Section -->
    <section class='bg-light' id='menu'>
        <div class='container'>
            <div class='text-center mb-5 reveal'>
                <h2 class='display-5 fw-bold'>Explore Our Menu</h2>
                <div class='fe-filter-bar mt-5'>
                    <button class='btn-filter active' data-fe-category='all'>All Dishes</button>
                    <button class='btn-filter' data-fe-category='Box'>Menu Boxes</button>
                    <button class='btn-filter' data-fe-category='Taco'>Sushi Tacos</button>
                    <button class='btn-filter' data-fe-category='Appetizer'>Appetizers</button>
                </div>
            </div>
            <div class='fe-product-grid' id='feProductRoot'/>
        </div>
    </section>

    <!-- Gallery Section (STEP 1: Fixed Logic) -->
    <section id='gallery'>
        <div class='container'>
            <div class='text-center mb-5 reveal'><h2 class='fw-bold display-5'>Visual Gallery</h2></div>
            <div class='fe-gallery-wrap' id='feGalleryRoot'/>
        </div>
    </section>

    <!-- Testimonials -->
    <section class='bg-light' id='testimonials'>
        <div class='container text-center'>
            <h2 class='display-5 fw-bold mb-5 reveal'>Customer Voices</h2>
            <div class='row g-4'>
                <div class='col-md-4'>
                    <div class='testimonial-card reveal' style='background:#fff; padding:30px; border-radius:25px;'>
                        <div class='text-warning mb-3 h4'><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/></div>
                        <p class='fst-italic'>&quot;The salmon was like butter. Fresh, delicate, and delivered in under 45 minutes!&quot;</p>
                        <h6 class='fw-bold mb-0 mt-4'>Sofia K.</h6>
                    </div>
                </div>
                <div class='col-md-4'>
                    <div class='testimonial-card reveal' style='background:#fff; padding:30px; border-radius:25px;'>
                        <div class='text-warning mb-3 h4'><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/></div>
                        <p class='fst-italic'>&quot;Our favorite sushi tacos in Casablanca. The crunch is unforgettable.&quot;</p>
                        <h6 class='fw-bold mb-0 mt-4'>Omar T.</h6>
                    </div>
                </div>
                <div class='col-md-4'>
                    <div class='testimonial-card reveal' style='background:#fff; padding:30px; border-radius:25px;'>
                        <div class='text-warning mb-3 h4'><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/><i class='bi bi-star-fill'/></div>
                        <p class='fst-italic'>&quot;Highly professional catering. They made our corporate event a huge success.&quot;</p>
                        <h6 class='fw-bold mb-0 mt-4'>Laila R.</h6>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id='contact'>
        <div class='container'>
            <h2 class='fw-bold display-5 mb-5'>Talk to Us</h2>
            <div class='row g-5 align-items-center'>
                <div class='col-lg-5 reveal'>
                    <h2 class='fw-bold display-5 mb-4'>Event Sushi</h2>
                    <p class='text-muted mb-1'>Authentic Japanese Cuisine in Morocco</p>
                </div>
                <div class='col-lg-7 reveal'>
                    <div class='contact-form-box'>
                        <h4 class='fw-bold mb-4'>Direct WhatsApp Inquiry</h4>
                        <input class='fe-control' id='conInpName' placeholder='Full Name' type='text'/>
                        <textarea class='fe-control' id='conInpMsg' placeholder='How can we help you?' rows='4'/>
                        <button class='btn btn-dark w-100 py-3 rounded-pill fw-bold' id='btnTriggerContactWA'>SEND TO WHATSAPP</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Cart Sidebar -->
    <div class='fe-sidebar' id='sideCartPanel'>
        <div class='side-head-box'>
            <h5 class='m-0 fw-bold'><i class='bi bi-bag-check-fill me-2'/>Your Basket</h5>
            <i class='bi bi-x-lg close-sidebar-trig' id='closeSideCart' style='cursor:pointer'/>
        </div>
        <div class='side-body-box' id='sideCartItemsList'/>
        <div class='side-foot-box' id='sideCartFooter' style='display:none;'>
            <div class='mb-4 p-3 bg-white rounded-4 border'>
                <div class='input-group input-group-sm'>
                    <input class='form-control border-0' id='fePromoIn' placeholder='Code (SUSHI10)' type='text'/>
                    <button class='btn btn-dark rounded-pill px-3' id='btnApplyPromo'>Apply</button>
                </div>
                <div class='small mt-2 fw-bold' id='fePromoStatus'/>
            </div>
            <div class='d-flex justify-content-between h4 fw-bold mb-4'>
                <span>Grand Total:</span> <span id='feFinalTotalDisplay'>0 DH</span>
            </div>
            <button class='btn btn-dark w-100 py-3 rounded-pill fw-bold' id='btnFinalCheckoutWA'>Complete Order</button>
        </div>
    </div>

    <!-- Wishlist Sidebar -->
    <div class='fe-sidebar' id='sideWishPanel'>
        <div class='side-head-box' style='background: var(--fe-danger);'>
            <h5 class='m-0 fw-bold'><i class='bi bi-heart-fill me-2'/>Favorites</h5>
            <i class='bi bi-x-lg close-sidebar-trig' id='closeSideWish' style='cursor:pointer'/>
        </div>
        <div class='side-body-box' id='sideWishItemsList'/>
    </div>

    <!-- STEP 2: Search Modal -->
    <div class='fe-modal-backdrop' id='modalSearchPanel'>
        <div class='fe-modal-inner' style='max-width: 500px; padding: 40px; text-align: center;'>
            <i class='bi bi-x-lg fe-modal-x' id='closeModalSearch'/>
            <h3 class='fw-bold mb-4'>Find Your Dish</h3>
            <input class='fe-control form-control-lg' id='feSearchIn' placeholder='Search for sushi, tacos...' type='text'/>
            <p class='small text-muted'>Typing will filter the menu automatically.</p>
        </div>
    </div>

    <!-- Quick View Modal -->
    <div class='fe-modal-backdrop' id='modalQuickView'>
        <div class='fe-modal-inner'>
            <i class='bi bi-x-lg fe-modal-x' id='closeModalQV'/>
            <div class='row g-4 align-items-center'>
                <div class='col-md-6'><img class='img-fluid rounded-5 shadow-sm' id='qvImgSrc' src=''/></div>
                <div class='col-md-6'>
                    <h1 class='fw-bold mb-3' id='qvTitleText'>Product</h1>
                    <div class='text-warning h5 mb-3' id='qvRatingRow'/>
                    <p class='text-muted mb-4 lead' id='qvDescText'/>
                    <h2 class='text-danger mb-5' id='qvPriceText'>0 DH</h2>
                    
                    <hr class='my-4'/>
                    <h6 class='fw-bold mb-3'>Customer Feedback</h6>
                    <div class='bg-light p-3 rounded-3 mb-3' id='qvReviewScroll' style='max-height:200px; overflow-y:auto;'/>

                    <textarea class='form-control rounded-4 mb-3 small' id='inUserComment' placeholder='Share your experience...' rows='2'/>
                    <div class='d-flex gap-3 mt-5'>
                        <button class='btn btn-dark btn-sm rounded-pill px-5' id='btnPostReview'>Post Review</button>
                    </div>

                    <button class='btn btn-dark w-100 py-3 rounded-pill fw-bold' id='btnModalAddCart'>Add to Basket</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div class='fe-modal-backdrop' id='modalAdminPanel'>
        <div class='fe-modal-inner' style='max-width: 900px;'>
            <i class='bi bi-x-lg fe-modal-x' id='closeModalAdmin'/>
            <h2 class='fw-bold mb-4'><i class='bi bi-shield-lock-fill me-2 text-primary'/>Master Control Panel</h2>
            <div class='table-responsive'>
                <table class='table align-middle'>
                    <thead class='table-dark'><tr><th>Product Item</th><th>Current Status</th><th>Toggle Logic</th></tr></thead>
                    <tbody id='adminStockTableBody'/>
                </table>
            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div class='fe-modal-backdrop' id='modalTableBooking'>
        <div class='fe-modal-inner' style='max-width: 500px; padding: 40px;'>
            <i class='bi bi-x-lg fe-modal-x' id='closeModalBook'/>
            <h3 class='fw-bold mb-4 text-center'>Table Reservation</h3>
            <div class='mb-4'>
                <label class='form-label small fw-bold'>Name</label>
                <input class='fe-control' id='bookInName' type='text'/>
            </div>
            <div class='mb-4'>
                <label class='form-label small fw-bold'>WhatsApp Number</label>
                <input class='fe-control' id='bookInPhone' type='tel'/>
            </div>
            <div class='row g-3 mb-4'>
                <div class='col-6'><label class='form-label small fw-bold'>Date</label><input class='fe-control' id='bookInDate' type='date'/></div>
                <div class='col-6'><label class='form-label small fw-bold'>Time</label><input class='fe-control' id='bookInTime' type='time'/></div>
            </div>
            <select class='fe-control' id='bookInGuests'>
                <option value='2'>2 Guests</option>
                <option value='4'>4 Guests</option>
                <option value='6'>6 Guests</option>
                <option value='10'>10+ Guests</option>
            </select>
            <button class='btn btn-dark w-100 py-3 rounded-pill fw-bold' id='btnSubmitBooking'>CONFIRM VIA WHATSAPP</button>
        </div>
    </div>

    <!-- Auth Modal -->
    <div class='fe-modal-backdrop' id='modalAuth'>
        <div class='fe-modal-inner' style='max-width: 400px; padding: 30px;'>
            <i class='bi bi-x-lg fe-modal-x' id='closeModalAuth'/>
            <h3 class='fw-bold mb-4 text-center'>Engine Access</h3>
            <div class='alert alert-warning small py-2 mb-4 text-center'>Login with <strong>admin@eventsushi.com</strong> for Admin rights.</div>
            <input class='fe-control' id='loginMailIn' placeholder='Email' type='email'/>
            <button class='btn btn-dark w-100 py-3 rounded-pill fw-bold' id='btnActionLogin'>SIGN IN</button>
        </div>
    </div>

    <!-- Floating Buttons -->
    <div class='fe-action-floats'>
        <a class='btn-fe-float f-wa' href='https://wa.me/212600000000' target='_blank'><i class='bi bi-whatsapp'/></a>
        <div class='btn-fe-float f-cart' id='feFloatCartBtn'><i class='bi bi-cart3'/></div>
    </div>

    <!-- Blogger Engine Section -->
    <b:section id='MainBloggerEngine' showaddelement='yes'/>

    <!-- Footer -->
    <footer class='reveal'>
        <div class='container'>
            <div class='foot-grid-wrap'>
                <div>
                    <h2 class='fw-bold text-white mb-4'>EVENT SUSHI</h2>
                    <p class='opacity-75 small'>The pioneer of authentic sushi fusion in Casablanca. Sourcing Atlantic freshness since 2014.</p>
                </div>
                <div>
                    <h6 class='foot-title-h'>Explore</h6>
                    <a class='foot-item-l' href='#hero'>Home</a>
                    <a class='foot-item-l' href='#about'>Our Story</a>
                    <a class='foot-item-l' href='#menu'>The Menu</a>
                    <a class='foot-item-l' href='#gallery'>Gallery</a>
                </div>
                <div>
                    <h6 class='foot-title-h'>Information</h6>
                    <a class='foot-item-l' href='#'>Privacy Policy</a>
                    <a class='foot-item-l' href='#'>Refund Policy</a>
                    <a class='foot-item-l' href='#'>Terms of Use</a>
                </div>
                <div>
                    <h6 class='foot-title-h'>Visit Us</h6>
                    <p class='small opacity-50 mb-4'>Maarif District, Casablanca. <br/> Open 11:00 AM - 11:00 PM</p>
                    <div class='d-flex gap-3'>
                        <a class='text-white h5' href='#'><i class='bi bi-instagram'/></a>
                        <a class='text-white h5' href='#'><i class='bi bi-facebook'/></a>
                    </div>
                </div>
            </div>
            <hr class='my-5 opacity-10'/>
            <p class='text-center small opacity-50 mb-0'>&amp;copy; 2026 Fusion Engine Framework. Developed by GORARY PRO.</p>
        </div>
    </footer>

    <!-- CONFIGURATION & LOGIC SCRIPT (UPDATED) -->
    <script type='text/javascript'>
    //<![CDATA[
    (function() {
        'use strict';

        /* --- 7.1 GLOBAL DATA CONFIGURATION --- */
        const FE = {
            waLink: "212600000000",
            rates: { "MAD": 1, "USD": 0.10, "EUR": 0.093 },
            sym: { "MAD": "DH", "USD": "$", "EUR": "‚Ç¨" },
            
            catalog: [
                { id: "p1", cat: "Box", title: "Salmon Lovers Box", price: 120, img: "https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=600", desc: "12 pieces of premium salmon nigiri and california rolls.", inStock: true },
                { id: "p2", cat: "Box", title: "Dragon King Platter", price: 155, img: "https://images.unsplash.com/photo-1553621042-f6e147245754?w=600", desc: "Artisan tempura shrimp roll topped with grilled unagi.", inStock: true },
                { id: "p3", cat: "Taco", title: "Spicy Tuna Nori Taco", price: 45, img: "https://images.unsplash.com/photo-1593560708920-61dd98c46a4e?w=600", desc: "Crunchy nori shell with spicy marinated tuna mash.", inStock: true },
                { id: "p4", cat: "Taco", title: "Salmon Avocado Taco", price: 40, img: "https://images.unsplash.com/photo-1617196034183-421b4917c92d?w=600", desc: "Light salmon cubes with lime-infused avocado mash.", inStock: true },
                { id: "p5", cat: "Appetizer", title: "Dynamite Shrimp", price: 85, img: "https://images.unsplash.com/photo-1559715745-e1b33a271c8f?w=600", desc: "Tempura battered shrimp in a spicy fire glaze.", inStock: true },
                { id: "p6", cat: "Appetizer", title: "Classic Miso Soup", price: 30, img: "https://images.unsplash.com/photo-1547592166-23ac45744acd?w=600", desc: "Traditional broth with silk tofu and spring onions.", inStock: true }
            ],
            
            gallery: [
                "https://images.unsplash.com/photo-1579584425555-c3ce17fd4351?q=80&amp;w=500",
                "https://images.unsplash.com/photo-1611143669185-af224c5e3252?q=80&amp;w=500",
                "https://images.unsplash.com/photo-1562436260-8c9216eeb703?q=80&amp;w=500",
                "https://images.unsplash.com/photo-1553621042-f6e147245754?q=80&amp;w=500",
                "https://images.unsplash.com/photo-1617196034651-361730097f4a?q=80&amp;w=500",
                "https://images.unsplash.com/photo-1583623025817-d180a2221d0a?q=80&amp;w=500"
            ],

            promos: [
                { code: "SUSHI10", val: 0.10, type: "percent" },
                { code: "MAD50", val: 50, type: "fixed" }
            ],

            state: {
                currency: localStorage.getItem('fe_curr') || 'MAD',
                cart: JSON.parse(localStorage.getItem('fe_cart')) || [],
                wish: JSON.parse(localStorage.getItem('fe_wish')) || [],
                user: JSON.parse(localStorage.getItem('fe_user')) || null,
                revs: JSON.parse(localStorage.getItem('fe_revs')) || { "p1": [{u:"Karim", s:5, t:"Fresh!"}], "p2": [] },
                discount: 0,
                discountMsg: ""
            }
        };

        /* --- 7.2 SELECTOR SAFETY ENGINE --- */
        const $ = function(id) { return document.getElementById(id); };
        const on = function(id, event, callback) {
            var el = $(id);
            if (el) el.addEventListener(event, callback);
        };

        /* --- 7.3 PRICE FORMATTING ENGINE --- */
        const formatP = function(madVal) {
            var r = FE.rates[FE.state.currency];
            var s = FE.sym[FE.state.currency];
            var calc = (madVal * r).toFixed(2);
            return FE.state.currency === 'MAD' ? calc + " DH" : s + calc;
        };

        /* --- 7.4 STAR RATING ENGINE --- */
        const getRat = function(id) {
            var rs = FE.state.revs[id] || [];
            if (!rs.length) return { a: 0, c: 0 };
            return { a: (rs.reduce(function(a,c) { return a + c.s; }, 0) / rs.length).toFixed(1), c: rs.length };
        };
        const stars = function(r) {
            var h = '';
            for (var i = 1; i <= 5; i++) h += '\u003Ci class="bi bi-star' + (i <= Math.round(r) ? '-fill' : '') + '"\u003E\u003C/i\u003E';
            return h;
        };

        /* --- 7.5 RENDER LOGIC: MENU --- */
        const renderProducts = function(data) {
            var root = $('feProductRoot');
            if(!root) return;
            root.innerHTML = '';
            if(data.length === 0) {
                root.innerHTML = '\u003Cdiv class="text-center w-100 py-5"\u003ENo products found.\u003C/div\u003E';
                return;
            }
            data.forEach(function(p) {
                var rt = getRat(p.id);
                var isW = FE.state.wish.includes(p.id);
                var stockClass = !p.inStock ? 'out-of-stock' : '';
                
                var cardHTML = '\u003Cdiv class="fe-card reveal active ' + stockClass + '"\u003E';
                cardHTML += '\u003Cbutton class="wish-overlay ' + (isW ? 'active' : '') + '" data-id="' + p.id + '"\u003E\u003Ci class="bi bi-heart-fill"\u003E\u003C/i\u003E\u003C/button\u003E';
                cardHTML += '\u003Cdiv class="card-media-box trigger-qv-logic" data-id="' + p.id + '"\u003E\u003Cimg src="' + p.img + '" loading="lazy"/\u003E\u003C/div\u003E';
                cardHTML += '\u003Cdiv class="card-info-box"\u003E';
                cardHTML += '\u003Cdiv class="star-display"\u003E' + stars(rt.a) + ' (' + rt.c + ')' + '\u003C/div\u003E';
                cardHTML += '\u003Ch5 class="fw-bold mb-2"\u003E' + p.title + '\u003C/h5\u003E';
                cardHTML += '\u003Cdiv class="d-flex justify-content-between align-items-start mt-4"\u003E';
                cardHTML += '\u003Cspan class="card-price-tag"\u003E' + formatP(p.price) + '\u003C/span\u003E';
                cardHTML += '\u003Cbutton class="btn btn-dark btn-sm rounded-pill px-4 btn-add-logic" data-id="' + p.id + '"' + (!p.inStock ? 'disabled' : '') + '\u003EAdd\u003C/button\u003E';
                cardHTML += '\u003C/div\u003E';
                cardHTML += '\u003C/div\u003E';
                
                root.insertAdjacentHTML('beforeend', cardHTML);
            });
        };

        /* --- 7.6 RENDER LOGIC: CART --- */
        const renderCart = function() {
            var list = $('sideCartItemsList');
            if(!list) return;
            list.innerHTML = '';
            var sum = 0;
            if(!FE.state.cart.length) {
                list.innerHTML = '\u003Cdiv class="text-center py-5 opacity-40"\u003E\u003Ci class="bi bi-cart-x display-1"\u003E\u003C/i\u003E\u003Cp class="mt-2"\u003EBasket Empty\u003C/p\u003E\u003C/div\u003E';
                if($('sideCartFooter')) $('sideCartFooter').style.display = 'none';
                if($('badgeCartCount')) $('badgeCartCount').textContent = '0';
                return;
            }
            FE.state.cart.forEach(function(item) {
                var p = FE.catalog.find(function(x) { return x.id === item.id; });
                if(p) {
                    sum += (p.price * item.qty);
                    var itemHTML = '\u003Cdiv class="cart-row-item"\u003E';
                    itemHTML += '\u003Cimg src="' + p.img + '"/\u003E';
                    itemHTML += '\u003Cdiv class="flex-grow-1"\u003E';
                    itemHTML += '\u003Ch6 class="fw-bold mb-1"\u003E' + p.title + '\u003C/h6\u003E';
                    itemHTML += '\u003Cdiv class="small text-muted"\u003E' + formatP(p.price) + '\u003C/div\u003E';
                    itemHTML += '\u003Cdiv class="qty-engine"\u003E';
                    itemHTML += '\u003Cbutton class="qty-btn" data-id="' + item.id + '" data-act="min"\u003E-\u003C/button\u003E';
                    itemHTML += '\u003Cspan class="small fw-bold"\u003E' + item.qty + '\u003C/span\u003E';
                    itemHTML += '\u003Cbutton class="qty-btn" data-id="' + item.id + '" data-act="plus"\u003E+\u003C/button\u003E';
                    itemHTML += '\u003C/div\u003E';
                    itemHTML += '\u003Ci class="bi bi-trash text-danger del-cart-trigger" data-id="' + item.id + '" style="cursor:pointer"\u003E\u003C/i\u003E';
                    itemHTML += '\u003C/div\u003E';
                    list.insertAdjacentHTML('beforeend', itemHTML);
                }
            });
            
            var discountAmt = 0;
            if(FE.state.discount > 0 && FE.state.discount <= 1) discountAmt = sum * FE.state.discount;
            else if(FE.state.discount > 1) discountAmt = FE.state.discount;

            var final = sum - discountAmt;
            if($('feFinalTotalDisplay')) $('feFinalTotalDisplay').textContent = formatP(final);
            if($('sideCartFooter')) $('sideCartFooter').style.display = 'block';
            if($('badgeCartCount')) $('badgeCartCount').textContent = FE.state.cart.length;
            if($('fePromoStatus')) $('fePromoStatus').textContent = FE.state.discountMsg;
            
            localStorage.setItem('fe_cart', JSON.stringify(FE.state.cart));
        };

        /* --- 7.7 RENDER LOGIC: WISHLIST --- */
        const renderWish = function() {
            var list = $('sideWishItemsList');
            list.innerHTML = '';
            if($('badgeWishCount')) $('badgeWishCount').textContent = FE.state.wish.length;
            if(FE.state.wish.length === 0) {
                list.innerHTML = '\u003Cdiv class="text-center py-5"\u003ENo items in wishlist.\u003C/div\u003E';
                return;
            }
            FE.state.wish.forEach(function(id) {
                var p = FE.catalog.find(function(x) { return x.id === id; });
                if(p) {
                    var wishHTML = '\u003Cdiv class="cart-row-item"\u003E';
                    wishHTML += '\u003Cimg src="' + p.img + '"/\u003E';
                    wishHTML += '\u003Cdiv class="flex-grow-1"\u003E';
                    wishHTML += '\u003Ch6 class="fw-bold mb-0"\u003E' + p.title + '\u003C/h6\u003E';
                    wishHTML += '\u003Cdiv class="small text-muted"\u003E' + formatP(p.price) + '\u003C/div\u003E';
                    wishHTML += '\u003C/div\u003E';
                    wishHTML += '\u003Ci class="bi bi-x-circle text-danger remove-wish-trigger" data-id="' + id + '" style="cursor:pointer"\u003E\u003C/i\u003E';
                    wishHTML += '\u003C/div\u003E';
                    list.insertAdjacentHTML('beforeend', wishHTML);
                }
            });
            localStorage.setItem('fe_wish', JSON.stringify(FE.state.wish));
        };

        /* --- 7.7.5 RENDER LOGIC: GALLERY (STEP 1 IMPLEMENTATION) --- */
        const renderGallery = function() {
            var root = $('feGalleryRoot');
            if(!root) return;
            root.innerHTML = '';
            FE.gallery.forEach(function(src) {
                var frameHTML = '\u003Cdiv class="gallery-frame reveal"\u003E\u003Cimg src="' + src + '" loading="lazy"/\u003E\u003C/div\u003E';
                root.insertAdjacentHTML('beforeend', frameHTML);
            });
        };

        /* --- 7.8 RENDER LOGIC: ADMIN --- */
        const renderAdmin = function() {
            var root = $('adminStockTableBody');
            if(!root) return;
            root.innerHTML = '';
            FE.catalog.forEach(function(p) {
                var rowHTML = '\u003Ctr\u003E';
                rowHTML += '\u003Ctd class="fw-bold small"\u003E' + p.title + '\u003C/td\u003E';
                rowHTML += '\u003Ctd\u003E\u003Cspan class="badge ' + (p.inStock ? 'bg-success' : 'bg-danger') + '"\u003E' + (p.inStock ? 'LIVE' : 'OUT') + '\u003C/span\u003E\u003C/td\u003E';
                rowHTML += '\u003Ctd\u003E\u003Cbutton class="btn btn-sm btn-dark toggle-stock-action" data-id="' + p.id + '"\u003ETOGGLE\u003C/button\u003E\u003C/td\u003E';
                rowHTML += '\u003C/tr\u003E';
                root.insertAdjacentHTML('beforeend', rowHTML);
            });
        };

        /* --- 7.9 CORE INTERACTION BINDING --- */
        const bindEvents = function() {
            
            // 1. FILTER LOGIC
            on('feGlobalCurrency', 'change', function(e) {
                FE.state.currency = e.target.value;
                localStorage.setItem('fe_curr', FE.state.currency);
                renderProducts(FE.catalog);
                renderCart(); 
                renderWish();
            });

            // 2. NAV ACTIONS
            on('trigUserAuth', 'click', function() { if($('modalAuth')) $('modalAuth').style.display = 'flex'; });
            on('trigWishSidebar', 'click', function() { renderWish(); if($('sideWishPanel')) $('sideWishPanel').classList.add('open'); if($('sideBackdrop')) $('sideBackdrop').style.display = 'block'; });
            on('trigCartSidebar', 'click', function() { renderCart(); if($('sideCartPanel')) $('sideCartPanel').classList.add('open'); if($('sideBackdrop')) $('sideBackdrop').style.display = 'block'; });
            
            var closeItems = document.querySelectorAll('.close-sidebar-trig');
            for(var i=0; i<closeItems.length; i++) { closeItems[i].onclick = closeAll; };
            
            var closeModals = document.querySelectorAll('.fe-modal-x');
            for(var i=0; i<closeModals.length; i++) { closeModals[i].onclick = closeAll; };

            // 3. SIDEBAR OPENERS
            const openSidebar = function(id) {
                var s = $(id);
                if(s) { s.classList.add('open'); if($('sideBackdrop')) $('sideBackdrop').style.display = 'block'; }
            };

            on('feFloatCartBtn', 'click', function() { openSidebar('sideCartPanel'); });

            // 4. MODAL OPENERS
            on('btnOpenBooking', 'click', function() { if($('modalTableBooking')) $('modalTableBooking').style.display = 'flex'; });

            // STEP 2: SEARCH MODAL OPEN
            on('trigSearch', 'click', function() { if($('modalSearchPanel')) { $('modalSearchPanel').style.display = 'flex'; if($('feSearchIn')) $('feSearchIn').focus(); } });
            on('closeModalSearch', 'click', closeAll);

            // STEP 2: SEARCH INPUT LOGIC
            on('feSearchIn', 'keyup', function(e) {
                var q = e.target.value.toLowerCase();
                if(q.length > 1) {
                    var filtered = FE.catalog.filter(function(p) { return p.title.toLowerCase().indexOf(q) > -1; });
                    renderProducts(filtered);
                    if($('modalSearchPanel')) $('modalSearchPanel').style.display = 'none';
                    document.querySelector('#menu').scrollIntoView({ behavior: 'smooth' });
                } else if (q.length === 0) {
                    renderProducts(FE.catalog);
                }
            });
            
            // 5. CART ACTIONS
            document.addEventListener('click', function(e) {
                var t = e.target;
                var id = t.dataset.id;

                if(t.classList.contains('btn-add-logic') || t.id === 'btnModalAddCart') {
                    var cid = t.id === 'btnModalAddCart' ? t.dataset.id : id;
                    var exists = FE.state.cart.find(function(item) { return item.id === cid; });
                    exists ? exists.qty++ : FE.state.cart.push({id: cid, qty: 1});
                    renderCart();
                    if(!t.closest('.fe-modal-inner')) openSidebar('sideCartPanel');
                }

                if(t.classList.contains('qty-btn')) {
                    var item = FE.state.cart.find(function(i) { return i.id === id; });
                    if(t.dataset.act === 'plus') item.qty++;
                    if(t.dataset.act === 'min' && item.qty > 1) item.qty--;
                    renderCart();
                }

                if(t.classList.contains('del-cart-trigger')) {
                    FE.state.cart = FE.state.cart.filter(function(i) { return i.id !== id; });
                    renderCart();
                }
            });

            // 6. PROMO LOGIC
            on('btnApplyPromo', 'click', function() {
                var code = $('fePromoIn').value.toUpperCase().trim();
                var found = FE.promos.find(function(p) { return p.code === code; });
                if(found) {
                    FE.state.discount = found.val;
                    FE.state.discountMsg = "Applied: " + found.code;
                    renderCart();
                } else {
                    FE.state.discount = 0;
                    FE.state.discountMsg = "Invalid Code";
                    renderCart();
                }
            });

            // 7. CONTACT LOGIC
            on('btnTriggerContactWA', 'click', function() {
                var n = $('conInpName').value;
                var m = $('conInpMsg').value;
                if(n && m) window.open("https://wa.me/" + FE.waLink + "?text=Hello, I am " + n + ". " + m, '_blank');
            });

            // 8. BOOKING LOGIC
            on('btnSubmitBooking', 'click', function() {
                var n = $('bookInName').value;
                var p = $('bookInPhone').value;
                var d = $('bookInDate').value;
                var tm = $('bookInTime').value;
                var g = $('bookInGuests').value;
                
                if(!n || !p || !d || !tm) { alert("Please fill all details"); return; }

                var msg = "Hi, I'd like to reserve a table.\n\n";
                msg += "üë§ Name: " + n + "\n";
                msg += "üìû Phone: " + p + "\n";
                msg += "üìÖ Date: " + d + "\n";
                msg += "‚è∞ Time: " + tm + "\n";
                msg += "üë• Guests: " + g + "\n";
                
                window.open("https://wa.me/" + FE.waLink + "?text=" + encodeURIComponent(msg), '_blank');
                closeAll();
            });

            // 9. QUICK VIEW LOGIC
            on('trigger-qv-logic', 'click', function(e) {
                var pid = e.target.closest('.trigger-qv-logic').dataset.id;
                var p = FE.catalog.find(function(x) { return x.id === pid; });
                
                if($('qvImgSrc')) $('qvImgSrc').src = p.img;
                if($('qvTitleText')) $('qvTitleText').textContent = p.title;
                if($('qvDescText')) $('qvDescText').textContent = p.desc;
                if($('qvPriceText')) $('qvPriceText').textContent = formatP(p.price);
                
                var rt = FE.state.revs[pid] || [];
                if($('qvRatingRow')) $('qvRatingRow').innerHTML = stars(rt.a) + ' (' + rt.c + ' reviews)';
                
                var list = $('qvReviewScroll');
                if(list) {
                    list.innerHTML = '';
                    (rt || []).forEach(function(rv) {
                        list.insertAdjacentHTML('beforeend', '\u003Cdiv class="mb-2 border-bottom pb-2 small"\u003E\u003Cstrong\u003E' + rv.u + '\u003C/strong\u003E: \u003Cspan class="text-muted"\u003E' + rv.t + '\u003C/span\u003E\u003C/div\u003E');
                    });
                }
                if($('modalQuickView')) {
                    $('modalQuickView').style.display = 'flex';
                    if($('btnModalAddCart')) $('btnModalAddCart').dataset.id = pid; 
                }
            });

            // 10. WISHLIST LOGIC (OPTIMIZED)
            document.addEventListener('click', function(e) {
                if (e.target.closest('.wish-overlay')) {
                    var pid = e.target.closest('.wish-overlay').dataset.id;
                    var btn = e.target.closest('.wish-overlay');
                    if(FE.state.wish.includes(pid)) {
                        FE.state.wish = FE.state.wish.filter(function(x) { return x !== pid; });
                        btn.classList.remove('active');
                    } else {
                        FE.state.wish.push(pid);
                        btn.classList.add('active');
                    }
                    renderWish(); 
                }

                if (e.target.classList.contains('remove-wish-trigger')) {
                    var pid = e.target.dataset.id;
                    FE.state.wish = FE.state.wish.filter(function(x) { return x !== pid; });
                    renderWish();
                }
            });

            // 11. AUTH & ADMIN
            on('adminFlag', 'click', function() { 
                if($('modalAdminPanel')) $('modalAdminPanel').style.display = 'flex'; 
                if(FE.state.user && FE.state.user.email === 'admin@eventsushi.com') $('adminFlag').style.display = 'block';
            });
            on('btnActionLogin', 'click', function() {
                var mail = $('loginMailIn').value;
                if(!mail) return;
                var user = { name: mail.split('@')[0], email: mail };
                localStorage.setItem('fe_user', JSON.stringify(user));
                location.reload();
            });
            
            // 12. POST REVIEW
            on('btnPostReview', 'click', function(e) {
                var pid = e.target.closest('.fe-modal-inner').querySelector('#btnModalAddCart').dataset.id;
                var txt = $('inUserComment').value;
                if(txt && FE.state.user) {
                    if(!FE.state.revs[pid]) FE.state.revs[pid] = [];
                    FE.state.revs[pid].push({u: FE.state.user.name, s: 5, t: txt});
                    localStorage.setItem('fe_revs', JSON.stringify(FE.state.revs));
                    var qvRoot = $('feProductRoot');
                    if(qvRoot) renderProducts(FE.catalog); 
                }
                $('inUserComment').value = '';
            });
        };

        /* --- 7.10 MODULE: SIDEBAR & MODAL CONTROLLERS --- */
        const closeSidebars = function() {
            document.querySelectorAll('.fe-sidebar').forEach(function(s) { s.classList.remove('open'); });
            document.querySelectorAll('.fe-modal-backdrop').forEach(function(m) { m.style.display = 'none'; });
            if($('sideBackdrop')) $('sideBackdrop').style.display = 'none';
        };

        const closeAll = function() {
            closeSidebars();
        };

        /* --- 7.11 MODULE: CHECKOUT LOGIC --- */
        on('btnFinalCheckoutWA', 'click', function() {
            if(FE.state.cart.length === 0) return;
            var out = "Sushi Order List:\n";
            var sum = 0;
            FE.state.cart.forEach(function(i) {
                var p = FE.catalog.find(function(x) { return x.id === i.id; });
                out += "- " + i.qty + "x " + p.title + " (" + formatP(p.price * i.qty) + ")\n";
                sum += p.price * i.qty;
            });
            out += "\nTotal: " + $('feFinalTotalDisplay').textContent;
            window.open("https://wa.me/" + FE.waLink + "?text=" + encodeURIComponent(out), '_blank');
            closeSidebars();
        });

        /* --- 7.12 BOOT ENGINE --- */
        const initializeEngine = function() {
            var currEl = $('feGlobalCurrency');
            if(currEl) currEl.value = FE.state.currency;

            renderProducts(FE.catalog);
            renderCart();
            renderWish();
            renderAdmin();
            
            // STEP 1: CALL GALLERY RENDER
            renderGallery();
            
            if(FE.state.user && FE.state.user.email === 'admin@eventsushi.com') {
                if($('adminFlag')) $('adminFlag').style.display = 'block';
            }
            
            bindEvents();
            
            // Reveal Animation Observer
            var observer = new IntersectionObserver(function(entries) {
                entries.forEach(function(entry) {
                    if(entry.isIntersecting) entry.target.classList.add('active');
                });
            }, { threshold: 0.1 });
            
            var revs = document.querySelectorAll('.reveal');
            for(var i=0; i<revs.length; i++) { observer.observe(revs[i]); }
        };

        window.onload = initializeEngine;
    })();
    //]]>
    </script>
</body>
</html>
